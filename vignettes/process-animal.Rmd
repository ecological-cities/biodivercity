---
title: "Process Animal Data"
subtitle: "Process animal survey data for model building"
author: "Edwin Tan"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Process Animal Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Dealing with data

Collected fauna survey data in the format detailed in the previous section can be easily subset with respect to `town`, `round` and/or `priority` with the `filter_observations()` function. For example, a specific set of surveys (i.e. butterfly surveys in Tampines from 2020-2021) can be filtered as follows:

```{r filter_obs example, eval = FALSE}
data(fauna)
data(surveys)

butterflies_tampines_round_2 <- 
  filter_observations(observations = fauna, survey_ref = surveys,
                      specify_taxon = "Lepidoptera",
                      specify_area = "TP",
                      specify_period = "2")
```

Checks can be performed to remove uncertain fauna identifications to prevent over-counting. 

```{r check taxon groups, eval = FALSE}

# full fauna data
rmspp_town <- check_taxongrps(fauna, level = "town")
rmspp_point <- check_taxongrps(fauna, level = "point")
rmspp <- list(town = rmspp_town, point = rmspp_point) # combine to list
rm(rmspp_town, rmspp_point)


# normalised fauna data - list of lists
rmspp_normalised <- 
  foreach(i = seq_along(fauna_normalised), 
          .packages = "tidyverse") %dopar% {
            
  rmspp_town <- check_taxongrps(fauna_normalised[[i]], level = "town")
  rmspp_point <- check_taxongrps(fauna_normalised[[i]], level = "point")
  rmspp_normalised <- list(town = rmspp_town, point = rmspp_point) # combine to list
  
  rmspp_normalised
          }

```

