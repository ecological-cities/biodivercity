<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="biodivercity">
<title>Process Landscape Data • biodivercity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Process Landscape Data">
<meta property="og:description" content="biodivercity">
<meta property="og:image" content="https://ecological-cities.github.io/biodivercity/reference/figures/logo.png">
<meta property="og:image:alt" content="Biodiversity Indices for City Landscapes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biodivercity</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/biodivercity.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/process-landscape.html">1. Process landscape data</a>
    <a class="dropdown-item" href="../articles/process-animal.html">2. Process animal data</a>
    <h6 class="dropdown-header" data-toc-skip>3. Build models</h6>
    <a class="dropdown-item" href="../articles/apply-models.html">4. Apply models</a>
    <a class="dropdown-item" href="../articles/test-models.html">5. Test models</a>
    <h6 class="dropdown-header" data-toc-skip>6. Scoring and benchmarking</h6>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more-details">More details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more-details">
    <a class="dropdown-item" href="../articles/more/animals-survey-protocols.html">Animals - Survey Protocols</a>
    <a class="dropdown-item" href="../articles/more/animals-data-summaries.html">Animals - Data summaries</a>
    <a class="dropdown-item" href="../articles/more/animals-species-analyses.html">Animals - Species-level analyses</a>
    <a class="dropdown-item" href="../articles/more/animals-simulate-missing-surveys.html">Animals - Simulate missing surveys</a>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Land cover patterns</h6>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Urban density</h6>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Monitoring vs. Planning</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Local diversity</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Community diversity</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Future updates</h6>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://xp-song.github.io/project/birt/">About</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ecological-cities/biodivercity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Process Landscape Data</h1>
            <h3 data-toc-skip class="subtitle">Download and process satellite and OpenStreetMap data</h3>
                        <h4 data-toc-skip class="author">Edwin Tan</h4>
            
            <h4 data-toc-skip class="date">2022-02-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ecological-cities/biodivercity/blob/HEAD/vignettes/process-landscape.Rmd" class="external-link"><code>vignettes/process-landscape.Rmd</code></a></small>
      <div class="d-none name"><code>process-landscape.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="download-open-source-landscape-data">Download open-source landscape data<a class="anchor" aria-label="anchor" href="#download-open-source-landscape-data"></a>
</h2>
<div class="section level3">
<h3 id="openstreetmap">OpenStreetMap<a class="anchor" aria-label="anchor" href="#openstreetmap"></a>
</h3>
<p>Urban landscape elements can be retrieved from the freely-available OpenStreetMap (OSM) database. Building polygons and road lines are extracted from a set geographical boundary with the functions <code>get_buildings_osm</code> and <code>get_roads_osm</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>osm_boundaries <span class="ot">&lt;-</span> <span class="fu">data</span>(boundaries) <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># st_union() %&gt;% # merge all subzones</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_make_valid</span>()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>buildings <span class="ot">&lt;-</span> <span class="fu">get_buildings_osm</span>(osm_boundaries,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2019-07-01"</span>, <span class="st">"2021-06-30"</span>)),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">dir_raw =</span> your_dir_raw,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">filename =</span> <span class="st">"osm_buildings.geojson"</span>)<span class="er">)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>roads <span class="ot">&lt;-</span> <span class="fu">get_roads_osm</span>(osm_boundaries,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2019-07-01"</span>, <span class="st">"2021-06-30"</span>)),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">dir_raw =</span> your_dir_raw,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">filename =</span> <span class="st">"osm_roads.geojson"</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="sentinel-2-satellite-images">Sentinel-2 satellite images<a class="anchor" aria-label="anchor" href="#sentinel-2-satellite-images"></a>
</h3>
<p>Landscape information is retrieved from the publicly available Sentinel-2 database using the <code>sen2r</code> package. As this is an external package unrelated to <code>biodivercity</code>, please also refer to the official repository for updated instructions. The package version used to generate this article is <code>sen2r_1.5.0</code>.</p>
<p>To model for fauna species richness across the six towns from 2016 to 2019, the spatio-temporal selections can be set accordingly to download all available Sentinel-2 images with the <code><a href="https://sen2r.ranghetti.info/reference/sen2r.html" class="external-link">sen2r()</a></code> function. The same parameters can be customised with a GUI interface by running <code><a href="https://sen2r.ranghetti.info/reference/sen2r.html" class="external-link">sen2r()</a></code> with no arguments, if preferred.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># http://sen2r.ranghetti.info/articles/installation.html</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"sen2r"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sen2r.ranghetti.info" class="external-link">sen2r</a></span><span class="op">)</span>

<span class="co"># run this after every successful download if there are still files in LTA not yet online, then subsequently check with provided safe_is_online() and sen2r():</span>
<span class="va">out_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sen2r.ranghetti.info/reference/sen2r.html" class="external-link">sen2r</a></span><span class="op">(</span>
  param_list <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">sen2r_params</span>,
  timewindow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">sen2r_date_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">sen2r_date_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
  path_l2a <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">sen2r_dir_rawdata</span>, <span class="co"># level-2A SAFE products</span>
  path_l1c <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">sen2r_dir_rawdata</span>, <span class="co"># level-1C SAFE products</span>
  path_out <span class="op">=</span> <span class="va">your_out_dir</span>,
  path_indices <span class="op">=</span> <span class="va">your_out_dir</span>,
  extent_as_mask <span class="op">=</span> <span class="cn">TRUE</span>,
  list_rgb <span class="op">=</span> <span class="st">"RGB432B"</span> <span class="co"># output RGB image</span>
  <span class="co"># max_mask = 15,</span>
  <span class="co"># list_indices = c("NDVI", "ARI")</span>
  <span class="op">)</span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="mosaic-rasters">Mosaic rasters<a class="anchor" aria-label="anchor" href="#mosaic-rasters"></a>
</h2>
<p>Raster files downloaded across multiple dates can be combined to create mosaics to account for cloud cover. Using the <code><a href="../reference/mosaic_sen2r.html">mosaic_sen2r()</a></code> function, this can be easily done with the file directory created by <code><a href="https://sen2r.ranghetti.info/reference/sen2r.html" class="external-link">sen2r()</a></code>, as specified in the <code>path_out</code> argument.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="../reference/mosaic_sen2r.html">mosaic_sen2r</a></span><span class="op">(</span>parent_dir <span class="op">=</span> <span class="va">out_dir</span>,
              exclude <span class="op">=</span> <span class="cn">NULL</span>,
              rm_outlier <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Downloaded rasters and the resulting mosaics contain raw information for specified indices. To account for noise and classify pixel values, Otsu’s thresholding (see article) can be used to define threshold values, where values above the threshold are regarded as a presence of the landscape type measured by an index.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/classify_image_binary.html">classify_image_binary</a></span><span class="op">(</span>image <span class="op">=</span> <span class="st">"out_dir/index/mosaic.tif"</span>,
                      threshold <span class="op">=</span> <span class="st">"otsu"</span><span class="op">)</span></code></pre></div>
<p>With the classified mosaics, landscape metrics can then be extracted at the defined buffer distances around fauna sampling points. The sample datasets <code>data(points)</code>, <code>data(NDVI)</code> and <code>data(NDWI2)</code> contains the survey points and the classified mosaics for NDVI and NDWI2.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">points</span><span class="op">)</span>
<span class="va">veg_classified</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">NDVI</span><span class="op">)</span>
<span class="va">water_classified</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">NDWI2</span><span class="op">)</span>

<span class="va">circles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lsm_perpoint.html">lsm_perpoint</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">veg_classified</span>, 
                        points <span class="op">=</span> <span class="va">points</span>, 
                        buffer_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">126</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">600</span>, <span class="fl">800</span>, <span class="fl">1000</span><span class="op">)</span>,
                        class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"veg"</span><span class="op">)</span>,
                        class_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,
                        landscape_name <span class="op">=</span> <span class="st">"veg"</span>,
                        level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span><span class="op">)</span> 

<span class="va">circles2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lsm_perpoint.html">lsm_perpoint</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">water_classified</span>, 
                         points <span class="op">=</span> <span class="va">points</span>,
                         buffer_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">126</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">600</span>, <span class="fl">800</span>, <span class="fl">1000</span><span class="op">)</span>,
                         class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"water"</span><span class="op">)</span>,
                         class_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,
                         landscape_name <span class="op">=</span> <span class="st">"water"</span>,
                         level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span><span class="op">)</span> 

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">circles</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># append to circles2 info to circles</span>
  <span class="va">circles</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">circles</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">circles2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
                 <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"lsm_"</span><span class="op">)</span>, 
                  <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">percentage_inside</span> <span class="op">&lt;</span> <span class="fl">90</span>, <span class="cn">NA</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
                <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">percentage_inside</span><span class="op">)</span>, 
              by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"point_id"</span>, <span class="st">"round"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Alternatively, certain desired landscape metrics can be specified for calculation via the <code>lsm_perpoint_specified</code> function instead of summarising the full suite of metrics. For example, to calculate the <code>pland</code> metric for the classified vegetation raster at multiple buffer distances:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predictors_lsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">126</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">600</span>, <span class="fl">800</span>, <span class="fl">1000</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">predictors_lsm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="va">dist</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"m_lsm_pland"</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">dist</span><span class="op">)</span>

<span class="va">pland</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lsm_perpoint_specified.html">lsm_perpoint_specified</a></span><span class="op">(</span>raster_list <span class="op">=</span> <span class="va">veg_classified</span>,
                                predictors_lsm <span class="op">=</span> <span class="va">predictors_lsm</span>,
                                class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"veg"</span><span class="op">)</span>,
                                class_values <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,
                                points <span class="op">=</span> <span class="va">points</span>,
                                point_id <span class="op">=</span> <span class="st">"point_id"</span>,
                                period <span class="op">=</span> <span class="st">"period"</span>
                                <span class="op">)</span></code></pre></div>
<p>The same can be also be performed for the downloaded OSM dataset.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predictors_osm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">126</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">600</span>, <span class="fl">800</span>, <span class="fl">1000</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">predictors_osm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="va">dist</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"m_osm_buildingFA_ratio"</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">buildingFA_ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/osm_perpoint_specified.html">osm_perpoint_specified</a></span><span class="op">(</span><span class="va">buildings</span>,
                                           <span class="va">predictors_osm</span>,
                                           building_ndsm <span class="op">=</span> <span class="cn">NULL</span>,
                                           building_height <span class="op">=</span> <span class="st">"height"</span>,
                                           building_levels <span class="op">=</span> <span class="st">"levels"</span>,
                                           road_lanes <span class="op">=</span> <span class="st">"lanes"</span>,
                                           <span class="va">points</span>,
                                           point_id <span class="op">=</span> <span class="st">"point_id"</span>,
                                           period <span class="op">=</span> <span class="st">"period"</span>
                                           <span class="op">)</span></code></pre></div>
<hr>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Copyright © 2022 <a href="https://github.com/kwekiii" class="external-link">Kwek Yan Chong</a>, <a href="https://xp-song.github.io" class="external-link">Xiao Ping Song</a>, <a href="https://github.com/JustinNai" class="external-link">Justin Nai</a>, <a href="https://github.com/edwintyw" class="external-link">Edwin Tan</a>, <a href="https://github.com/hongjhun" class="external-link">Hong Jhun Sim</a> and contributors.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p><em>biodivercity</em> is a part of <a href="https://github.com/ecological-cities" class="external-link"><strong>ecological-cities</strong></a></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
