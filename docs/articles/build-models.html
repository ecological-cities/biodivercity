<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="biodivercity">
<title>Build Models • biodivercity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build Models">
<meta property="og:description" content="biodivercity">
<meta property="og:image" content="https://ecological-cities.github.io/biodivercity/reference/figures/logo.png">
<meta property="og:image:alt" content="Spatial predictions of biodiversity across city landscapes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biodivercity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/biodivercity.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/process-animal.html">1. Process animal data</a>
    <a class="dropdown-item" href="../articles/process-landscape.html">2. Process landscape data</a>
    <a class="dropdown-item" href="../articles/build-models.html">3. Build models</a>
    <a class="dropdown-item" href="../articles/apply-models.html">4. Apply models</a>
    <a class="dropdown-item" href="../articles/use-cases.html">5. Use cases</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more-details">More details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more-details">
    <a class="dropdown-item" href="../articles/more/animals-survey-protocols.html">Animals - Survey protocols</a>
    <a class="dropdown-item" href="../articles/more/animals-data-summaries.html">Animals - Data summaries</a>
    <a class="dropdown-item" href="../articles/more/animals-species-analyses.html">Animals - Species-level analyses</a>
    <a class="dropdown-item" href="../articles/more/animals-simulate-missing-surveys.html">Animals - Simulate missing surveys</a>
    <a class="dropdown-item" href="../articles/more/test-models.html">Models - Test accuracy</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ecological-cities/biodivercity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="build-models_files/kePrint-0.0.1/kePrint.js"></script><link href="build-models_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Build Models</h1>
            <h3 data-toc-skip class="subtitle">Train models that predict
animal diversity from landscape data</h3>
            
            <h4 data-toc-skip class="date">2022-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ecological-cities/biodivercity/blob/HEAD/vignettes/build-models.Rmd" class="external-link"><code>vignettes/build-models.Rmd</code></a></small>
      <div class="d-none name"><code>build-models.Rmd</code></div>
    </div>

    
    
<p>This article outlines a workflow to build predictive models of
diversity for a chosen animal group. Fauna and landscape data should
have already been prepared based on
<code><a href="../articles/process-animal.html">vignette("process-animal")</a></code> and
<code><a href="../articles/process-landscape.html">vignette("process-landscape")</a></code>, respectively. Based on
community ecology theory, we ‘decompose’ animal diversity into two
components: (1) local (<em>Alpha</em>) diversity and (2) community
(<em>Beta</em>) diversity. A predictive model will be built for each
component.</p>
<p><br></p>
<img src="framework_build-models.png" width="70%" style="display: block; margin: auto;"><center>
<b> Figure: Broad overview of the data workflow for a chosen animal
group </b>
</center>
<p><br></p>
<p>First, load the necessary packages used throughout this article:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/ecological-cities/biodivercity" class="external-link">"biodivercity"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org" class="external-link">"tidyverse"</a></span><span class="op">)</span> <span class="co"># to process/wrangle data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span><span class="op">)</span> <span class="co"># to process landscape data</span></code></pre></div>
<p><br></p>
<hr>
<div class="section level2">
<h2 id="local-alpha-diversity">1. Local (<em>Alpha</em>) diversity<a class="anchor" aria-label="anchor" href="#local-alpha-diversity"></a>
</h2>
<p>For a chosen animal group, local (<em>Alpha</em>) diversity is
represented by the number of species recorded at sampling point
locations (i.e., species density). The response variable is the number
(count) of species. Generalised linear mixed-effects models (GLMMs) can
be used to model count data, and linear models are generally simpler and
provide better interpretability. Do note that other types of
models/algorithms can also be used to model count data. Also, the full
list of potential predictor variables may first be narrowed down; for
example, random forest models may be used to select variables based on
their relative importance in improving model performance (Arthur et al.,
2010; Li et al., 2017).</p>
<p>Load the necessary packages to model local (<em>Alpha</em>)
diversity:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/" class="external-link">"lme4"</a></span><span class="op">)</span> <span class="co"># mixed-effects modelling</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"MuMIn"</span><span class="op">)</span> <span class="co"># model selection &amp; averaging</span></code></pre></div>
<p>Load the example datasets for birds (animal group ‘Aves’) recorded at
sampling points across Singapore. <code>birds</code> is a dataframe
containing the number of species aggregated across multiple surveys
(i.e., species richness; column ‘<code>sprich</code>’), and
<code>landscape</code> is a dataframe containing landscape predictors
summarised within specified buffer radii. These example datasets can be
obtained by following the steps in <code>vignette(process-animal)</code>
and <code>vignette(process-landscape)</code>, respectively. See
<code>data(animal_surveys)</code> and
<code>data(points_landscape)</code> for further details about the
underlying animal and landscape data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"build-models_alpha-diversity.Rdata"</span>, package<span class="op">=</span><span class="st">"biodivercity"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">filepath</span><span class="op">)</span></code></pre></div>
<p>Pivot the <code>landscape_data</code> to wide format, with the prefix
<code>r&lt;radius&gt;m_</code> (representing the radius size) appended
to the column names of predictors:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">landscape</span> <span class="op">&lt;-</span> <span class="va">landscape</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"osm_"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"lsm_"</span><span class="op">)</span><span class="op">)</span>,
               names_to <span class="op">=</span> <span class="st">'metric'</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"town"</span>, <span class="st">"point_id"</span><span class="op">)</span>,
              names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"radius_m"</span>, <span class="st">"metric"</span><span class="op">)</span>, 
              values_from <span class="op">=</span> <span class="st">"value"</span>,
              names_glue <span class="op">=</span> <span class="st">"r{radius_m}m_{metric}"</span><span class="op">)</span>

<span class="co"># combine bird and landscape data, then then scale/center variables</span>
<span class="va">birds</span> <span class="op">&lt;-</span> <span class="va">birds</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">landscape</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"town"</span>, <span class="st">"point_id"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">birds_scaled</span> <span class="op">&lt;-</span> <span class="va">birds</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">sprich</span>, <span class="va">scale</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">birds_scaled</span><span class="op">)</span> <span class="co"># view combined data</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 × 20</span></span>
<span class="co">##   town  priority point…¹ sprich r200m_…² r200m…³ r200m…⁴ r200m…⁵ r200m…⁶ r200m…⁷</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> PG    Aves     PGT15       14  0.003<span style="text-decoration: underline;">03</span>  0.575    0.694  -<span style="color: #BB0000;">0.497</span>  -<span style="color: #BB0000;">0.559</span>   0.456</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> PG    Aves     PGT14       21  0.852    0.344    1.72   -<span style="color: #BB0000;">0.485</span>  -<span style="color: #BB0000;">0.496</span>   0.621</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> PG    Aves     PGT6        21  1.66     0.997    2.71   -<span style="color: #BB0000;">0.511</span>  -<span style="color: #BB0000;">0.544</span>   1.01 </span>
<span class="co">## <span style="color: #BCBCBC;">4</span> QT    Aves     QTNa14…     34 -<span style="color: #BB0000;">1.17</span>    -<span style="color: #BB0000;">0.027</span><span style="color: #BB0000; text-decoration: underline;">9</span>  -<span style="color: #BB0000;">0.740</span>   3.54    3.40   -<span style="color: #BB0000;">0.859</span></span>
<span class="co">## <span style="color: #BCBCBC;">5</span> QT    Aves     QTNb1a…     40 -<span style="color: #BB0000;">1.35</span>    -<span style="color: #BB0000;">0.948</span>   -<span style="color: #BB0000;">0.799</span>   1.60    1.31   -<span style="color: #BB0000;">1.97</span> </span>
<span class="co">## <span style="color: #BCBCBC;">6</span> PG    Aves     PGT7        18  1.33     0.801    2.52   -<span style="color: #BB0000;">0.472</span>  -<span style="color: #BB0000;">0.490</span>   0.440</span>
<span class="co">## <span style="color: #949494;"># … with 10 more variables: r200m_lsm_veg_lpi &lt;dbl[,1]&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   r200m_lsm_veg_pland &lt;dbl[,1]&gt;, r400m_osm_buildingVol_m3 &lt;dbl[,1]&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   r400m_osm_laneDensity &lt;dbl[,1]&gt;, r400m_osm_buildingFA_ratio &lt;dbl[,1]&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   r400m_lsm_veg_area_mn &lt;dbl[,1]&gt;, r400m_lsm_veg_gyrate_mn &lt;dbl[,1]&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   r400m_lsm_veg_ed &lt;dbl[,1]&gt;, r400m_lsm_veg_lpi &lt;dbl[,1]&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   r400m_lsm_veg_pland &lt;dbl[,1]&gt;, and abbreviated variable names ¹​point_id,</span></span>
<span class="co">## <span style="color: #949494;">#   ²​r200m_osm_buildingVol_m3[,1], ³​r200m_osm_laneDensity[,1], …</span></span></code></pre>
<p>To fit the model as a GLMM, the function <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge()</a></code>
will be used. The function includes customisation options; for instance,
the <code>subset</code> argument allows the user to exclude certain
combinations of variables within the fitted model (i.e., apply
constraints to possible models that may be built). In the following
example, we do not allow the same landscape predictor summarised within
multiple buffer radii to be present in the same model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^r[0-9]+m_"</span>,  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">birds_scaled</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># get predictor names</span>

<span class="co"># get rows with same predictors but different radii</span>
<span class="va">var_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="va">predictors</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># unique combinations</span>
  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># separate radii &amp; predictors</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">V1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1_radius"</span>, <span class="st">"V1_predictor"</span><span class="op">)</span>,
           sep <span class="op">=</span> <span class="st">"(?&lt;=[0-9])m_(?=[A-Za-z]*)"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">V2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V2_radius"</span>, <span class="st">"V2_predictor"</span><span class="op">)</span>,
           sep <span class="op">=</span> <span class="st">"(?&lt;=[0-9])m_(?=[A-Za-z]*)"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>similar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">V1_predictor</span>, <span class="va">V2_predictor</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="va">similar</span><span class="op">)</span><span class="op">)</span>

<span class="co"># create object to be supplied to function argument</span>
<span class="va">subset_vect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">var_comb</span><span class="op">$</span><span class="va">V1</span>, <span class="st">"&amp;"</span>, <span class="va">var_comb</span><span class="op">$</span><span class="va">V2</span><span class="op">)</span>
<span class="va">subset_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"!("</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">subset_vect</span>, collapse <span class="op">=</span> <span class="st">") &amp; !("</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="co"># function argument requires an expression</span></code></pre></div>
<p>Next, we fit both a global (maximal) model and null model, in order
to calculate the difference in Akaike Information Criterion (AIC) value
within the function <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge()</a></code>. In the example data,
the ‘<code>town</code>’ is specified as the random effect. The argument
‘<code>family</code>’ is specified as <code>"poisson"</code>, since the
response variable is count data. See the function
<code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer()</a></code> for more details and information on its
arguments.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_global</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"sprich"</span>, <span class="st">"~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">predictors</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span>, 
              <span class="st">"+ (1|town) "</span><span class="op">)</span>,
        family <span class="op">=</span> <span class="st">"poisson"</span>,
        na.action <span class="op">=</span> <span class="st">"na.fail"</span>,
        control <span class="op">=</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span>,
        data <span class="op">=</span> <span class="va">birds_scaled</span><span class="op">)</span>

<span class="va">model_null</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">sprich</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">town</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, data <span class="op">=</span> <span class="va">birds_scaled</span><span class="op">)</span></code></pre></div>
<p>Automated model selection is performed using the function
<code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge()</a></code>. Models are ranked based on their
<code>AICc</code> value (AIC adjusted for small sample sizes). Model
constraints are specified in the argument <code>subset</code>. To avoid
a long runtime in this demonstration, we also limit the number of
predictor variables in each model to four (argument
<code>m.lim</code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">dredge</a></span><span class="op">(</span><span class="va">model_global</span>,
                    subset<span class="op">=</span> <span class="va">subset_exp</span>,
                    m.lim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">4</span><span class="op">)</span>, <span class="co"># max of 4 variables</span>
                    rank<span class="op">=</span><span class="st">"AICc"</span><span class="op">)</span></code></pre></div>
<p>The resulting object contains a model selection table, with each row
representing a model that was fit. It is arranged in ascending order,
based on AIC value (lower AIC value represents a ‘better’ model). A
summary of the top models with values of ΔAIC &lt; 2 can be viewed:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bestmodels_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">model_glm</span>, 
                         <span class="va">delta</span> <span class="op">&lt;</span> <span class="fl">2</span>, 
                         recalc.weights<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">bestmodels_info</span>, caption <span class="op">=</span> <span class="st">"**Summary of best models ranked based on automated model selection from `MuMIn::dredge()` (ΔAIC &lt; 2).**"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html" class="external-link">scroll_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"300px"</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<strong>Summary of best models ranked based on automated model selection
from <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge()</a></code> (ΔAIC &lt; 2).</strong>
</caption>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
(Intercept)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r200m_lsm_veg_area_mn
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r200m_lsm_veg_ed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r200m_lsm_veg_gyrate_mn
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r200m_lsm_veg_lpi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r200m_lsm_veg_pland
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r200m_osm_buildingFA_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r200m_osm_buildingVol_m3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r200m_osm_laneDensity
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_lsm_veg_area_mn
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_lsm_veg_ed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_lsm_veg_gyrate_mn
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_lsm_veg_lpi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_lsm_veg_pland
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_osm_buildingFA_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_osm_buildingVol_m3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_osm_laneDensity
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
logLik
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
AICc
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
delta
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
weight
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
197
</td>
<td style="text-align:right;">
3.196216
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0551637
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.1359401
</td>
<td style="text-align:right;">
-0.0850794
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-365.8589
</td>
<td style="text-align:right;">
742.2395
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.05939683
</td>
</tr>
<tr>
<td style="text-align:left;">
194
</td>
<td style="text-align:right;">
3.196120
</td>
<td style="text-align:right;">
0.0514166
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.1412017
</td>
<td style="text-align:right;">
-0.0832377
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-366.1590
</td>
<td style="text-align:right;">
742.8397
</td>
<td style="text-align:right;">
0.6002541
</td>
<td style="text-align:right;">
0.04399666
</td>
</tr>
<tr>
<td style="text-align:left;">
199
</td>
<td style="text-align:right;">
3.195786
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.0256461
</td>
<td style="text-align:right;">
0.0461363
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.1280837
</td>
<td style="text-align:right;">
-0.0802518
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-365.3751
</td>
<td style="text-align:right;">
743.4871
</td>
<td style="text-align:right;">
1.2475980
</td>
<td style="text-align:right;">
0.03183104
</td>
</tr>
<tr>
<td style="text-align:left;">
709
</td>
<td style="text-align:right;">
3.196645
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0488160
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.1267322
</td>
<td style="text-align:right;">
-0.0812710
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.0231842
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-365.4697
</td>
<td style="text-align:right;">
743.6763
</td>
<td style="text-align:right;">
1.4368451
</td>
<td style="text-align:right;">
0.02895718
</td>
</tr>
<tr>
<td style="text-align:left;">
8389
</td>
<td style="text-align:right;">
3.195210
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0542352
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.1271918
</td>
<td style="text-align:right;">
-0.0833486
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.0209911
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-365.5583
</td>
<td style="text-align:right;">
743.8534
</td>
<td style="text-align:right;">
1.6139420
</td>
<td style="text-align:right;">
0.02650332
</td>
</tr>
<tr>
<td style="text-align:left;">
205
</td>
<td style="text-align:right;">
3.195503
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0447909
</td>
<td style="text-align:right;">
0.0269169
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.1262190
</td>
<td style="text-align:right;">
-0.0771083
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-365.5612
</td>
<td style="text-align:right;">
743.8592
</td>
<td style="text-align:right;">
1.6196856
</td>
<td style="text-align:right;">
0.02642731
</td>
</tr>
<tr>
<td style="text-align:left;">
229
</td>
<td style="text-align:right;">
3.195477
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0553025
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.0183244
</td>
<td style="text-align:right;">
-0.1260268
</td>
<td style="text-align:right;">
-0.0838809
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-365.6520
</td>
<td style="text-align:right;">
744.0408
</td>
<td style="text-align:right;">
1.8013640
</td>
<td style="text-align:right;">
0.02413249
</td>
</tr>
<tr>
<td style="text-align:left;">
196
</td>
<td style="text-align:right;">
3.195746
</td>
<td style="text-align:right;">
0.0419566
</td>
<td style="text-align:right;">
-0.0251969
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.1331441
</td>
<td style="text-align:right;">
-0.0792678
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-365.7112
</td>
<td style="text-align:right;">
744.1592
</td>
<td style="text-align:right;">
1.9197703
</td>
<td style="text-align:right;">
0.02274524
</td>
</tr>
<tr>
<td style="text-align:left;">
706
</td>
<td style="text-align:right;">
3.196583
</td>
<td style="text-align:right;">
0.0449303
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.1311233
</td>
<td style="text-align:right;">
-0.0796107
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.0241621
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-365.7387
</td>
<td style="text-align:right;">
744.2143
</td>
<td style="text-align:right;">
1.9747749
</td>
<td style="text-align:right;">
0.02212821
</td>
</tr>
</tbody>
</table>
</div>
<p>We can also visualise the importance (based on sum-of-weights) and
effect direction (based on coefficient value) for each variable within
the top models:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># average the effect of each predictor</span>
<span class="va">effects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">bestmodels_info</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># get importance of each predictor</span>
<span class="va">importances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">MuMIn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/sumofweights.html" class="external-link">sw</a></span><span class="op">(</span><span class="va">bestmodels_info</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>imp <span class="op">=</span> <span class="va">MuMIn..sw.bestmodels_info.</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"var"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">effects</span>, by <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># join with effects</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span>, <span class="st">"Mixed (factor)"</span>, <span class="va">effect</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">effect</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span>, <span class="st">"Mixed (factor)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">importances</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">imp</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">var</span>, <span class="va">imp</span><span class="op">)</span>, 
                     fill <span class="op">=</span> <span class="va">effect</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sum of weights"</span>, y <span class="op">=</span> <span class="st">"Variables"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4daf4a"</span>, <span class="st">"#e41a1c"</span>, <span class="st">"#377eb8"</span><span class="op">)</span>,
                    name <span class="op">=</span> <span class="st">"Effect"</span><span class="op">)</span></code></pre></div>
<p><img src="build-models_files/figure-html/plot%20important%20variables-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>Finally, we can extract the models and <code><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipes::recipe()</a></code>
objects for future use:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get list of best models</span>
<span class="va">bestmodels</span> <span class="op">&lt;-</span> <span class="fu">MuMIn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/get.models.html" class="external-link">get.models</a></span><span class="op">(</span><span class="va">bestmodels_info</span>, subset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># create recipes object only with predictors within best models</span>
<span class="va">predictors_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">bestmodels_info</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="va">birds</span> <span class="op">&lt;-</span> <span class="va">birds</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># original unscaled dataset</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sprich</span>, <span class="va">town</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">predictors_best</span><span class="op">)</span><span class="op">)</span> <span class="co"># remove unnecessary columns</span>

<span class="va">recipe_birds</span> <span class="op">&lt;-</span> <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">birds</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/roles.html" class="external-link">update_role</a></span><span class="op">(</span><span class="va">sprich</span>, new_role <span class="op">=</span> <span class="st">"outcome"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/roles.html" class="external-link">update_role</a></span><span class="op">(</span><span class="va">town</span>, new_role <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/update_role_requirements.html" class="external-link">update_role_requirements</a></span><span class="op">(</span><span class="st">"id"</span>, bake <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/step_normalize.html" class="external-link">step_normalize</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">predictors_best</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><br></p>
<hr>
</div>
<div class="section level2">
<h2 id="community-beta-diversity">2. Community (<em>Beta</em>) diversity<a class="anchor" aria-label="anchor" href="#community-beta-diversity"></a>
</h2>
<p>Partial regularised discriminant analysis (RDA) models may be used to
model the relationship between animal communities and landscape
predictors, while considering the inherent spatial structure of these
animal communities. The landscape predictors will be summarised as
Principal Component Analysis (PCA) axes, and the spatial variation
quantified using Principle Coordinates of Neighbourhood Matrices
(PCNM).</p>
<p>Similar to the models for local (<em>Alpha</em>) diversity, the full
list of potential predictor variables may first be narrowed down, for
example, by performing random forest modelling using the packages
<code>randomForestSRC</code> and
<code>MultivariateRandomForest</code>.</p>
<p>Load the necessary packages to model community (<em>Beta</em>)
diversity:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/vegandevs/vegan" class="external-link">"vegan"</a></span><span class="op">)</span></code></pre></div>
<p>As before, bird and landscape data at sampling points across six
areas (towns) in Singapore will be used. <code>bird_com</code> is a a
presence/absence community matrix; for each species (columns) at each
sampling point (rows), presence is denoted as <code>1</code> while
absence is denoted as <code>0</code>. <code>landscape</code> is a
dataframe containing landscape predictors summarised within specified
buffer radii. These example datasets can be obtained by following the
steps in <code>vignette(process-animal)</code> and
<code>vignette(process-landscape)</code>, respectively.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"build-models_beta-diversity.Rdata"</span>, package<span class="op">=</span><span class="st">"biodivercity"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">filepath</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sampling_points"</span><span class="op">)</span> <span class="co"># has geolocation information for PCNM analysis</span></code></pre></div>
<p>Pivot the <code>landscape</code> data to wide format, with the prefix
<code>r&lt;radius&gt;m_</code> (representing the radius size) appended
to the column names of predictors:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">landscape</span> <span class="op">&lt;-</span> <span class="va">landscape</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"osm_"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"lsm_"</span><span class="op">)</span><span class="op">)</span>,
               names_to <span class="op">=</span> <span class="st">'metric'</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"point_id"</span><span class="op">)</span>,
              names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"radius_m"</span>, <span class="st">"metric"</span><span class="op">)</span>, 
              values_from <span class="op">=</span> <span class="st">"value"</span>,
              names_glue <span class="op">=</span> <span class="st">"r{radius_m}m_{metric}"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="op">~</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># remove cols with all NA</span></code></pre></div>
<p>Add geolocation information to <code>landscape</code>, in preparation
for PCNM analysis:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">landscape</span> <span class="op">&lt;-</span> <span class="va">landscape</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="op">{</span><span class="op">(</span><span class="va">sampling_points</span><span class="op">$</span><span class="va">geometry</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">$</span><span class="va">point_id</span>,<span class="va">sampling_points</span><span class="op">$</span><span class="va">point_id</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
                 <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">}</span>,
         .after <span class="op">=</span> <span class="va">point_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>X <span class="op">=</span> <span class="op">{</span><span class="op">(</span><span class="va">sampling_points</span><span class="op">$</span><span class="va">geometry</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">$</span><span class="va">point_id</span>,<span class="va">sampling_points</span><span class="op">$</span><span class="va">point_id</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
                 <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">}</span>, 
         .after <span class="op">=</span> <span class="va">point_id</span><span class="op">)</span></code></pre></div>
<p>Perform principal component analysis (PCA) to summarise the landscape
predictors. Retain only PCA axes with eigenvalues greater than one, to
select for PCA axes that account for more variance than the original
variables on their own.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">landscape_pca</span> <span class="op">&lt;-</span> <span class="va">landscape</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">point_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># remove unnecessary columns</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">.</span>, scale.<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">pca_selected</span> <span class="op">&lt;-</span> <span class="va">landscape_pca</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">landscape_pca</span><span class="op">$</span><span class="va">sdev</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Calculate the PCNM vectors using <code><a href="https://rdrr.io/pkg/vegan/man/pcnm.html" class="external-link">vegan::pcnm()</a></code> and fit
the animal community matrix against these PCNM vectors using
<code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">vegan::rda()</a></code>. To control for type I error while testing for
significant predictors, significant PCNM vectors can first be selected
using a backwards, stepwise elimination method until all vectors have a
significance level smaller than the chosen significance level of 0.05
(Peres-Neto &amp; Legendre, 2010). This can be performed using
<code><a href="https://rdrr.io/pkg/vegan/man/ordistep.html" class="external-link">vegan::ordistep()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plots_xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">$</span><span class="va">X</span>, <span class="va">landscape</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span>
<span class="va">pcnm_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/pcnm.html" class="external-link">pcnm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">plots_xy</span><span class="op">)</span><span class="op">)</span>

<span class="va">pcnm_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">pcnm_raw</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">pcnm_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></span><span class="op">(</span><span class="va">bird_com</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">pcnm_scores</span><span class="op">)</span>
<span class="va">pcnm_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordistep.html" class="external-link">ordistep</a></span><span class="op">(</span><span class="va">pcnm_all</span>, direction <span class="op">=</span> <span class="st">"backward"</span>, pout <span class="op">=</span> <span class="fl">0.075</span><span class="op">)</span></code></pre></div>
<p>Perform partial RDA with the selected PCA axes as candidate
explanatory variables and the significant PCNM vectors as covariates.
Perform <code><a href="https://rdrr.io/pkg/vegan/man/ordistep.html" class="external-link">vegan::ordistep()</a></code> to select for the significant PCA
axes while accounting for the effects of the covariables in the model,
until all PCA axes have a significance level smaller than the chosen
significance level of 0.05.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predictors_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pca_selected</span>, <span class="va">pcnm_scores</span><span class="op">)</span>

<span class="va">rda_all</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">pcnm_subset</span>, 
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~. +"</span>, 
                <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pca_selected</span><span class="op">)</span><span class="op">)</span>, <span class="co"># add selected PCA</span>
                       collapse<span class="op">=</span><span class="st">" +"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>, 
         data <span class="op">=</span> <span class="va">predictors_selected</span><span class="op">)</span>

<span class="va">rda_subset</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/ordistep.html" class="external-link">ordistep</a></span><span class="op">(</span><span class="va">rda_all</span>, direction <span class="op">=</span> <span class="st">"backward"</span><span class="op">)</span> <span class="co"># assess p-value for dropping variables</span></code></pre></div>
<p>The final RDA model is fitted with the significant PC axes and PCNM
vectors.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rda_subset</span><span class="op">$</span><span class="va">call</span></code></pre></div>
<pre><code><span class="co">## rda(formula = bird_com ~ PCNM1 + PCNM2 + PCNM3 + PCNM4 + PCNM5 + </span>
<span class="co">##     PC1 + PC3 + PC4, data = predictors_selected)</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_rda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></span><span class="op">(</span><span class="va">bird_com</span> <span class="op">~</span> <span class="va">PC1</span> <span class="op">+</span> <span class="va">PC3</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">PCNM1</span> <span class="op">+</span> <span class="va">PCNM2</span> <span class="op">+</span> <span class="va">PCNM3</span> <span class="op">+</span> <span class="va">PCNM4</span> <span class="op">+</span> <span class="va">PCNM5</span> <span class="op">+</span> <span class="va">PCNM25</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">predictors_selected</span><span class="op">)</span></code></pre></div>
<p>Lastly, calculate the average probability of each species occurring
across all points.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_hats_birds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">bird_com</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></code></pre></div>
<p>These are the required objects to use the predictive model for
community (<em>Beta</em>) diversity in subsequent articles:</p>
<ol style="list-style-type: decimal">
<li>landscape_pca</li>
<li>pcnm_raw</li>
<li>model_rda</li>
<li>p_hats_birds</li>
</ol>
<p><br></p>
<hr>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Arthur AD, Li J, Henry S &amp; Cunningham SA (2010) Influence of
woody vegetation on pollinator densities in oilseed Brassica fields in
an Australian temperate landscape. <em>Basic and Applied Ecology</em>,
<em>11</em>(5): 406–414.</p>
<p>Li J, Alvarez B, Siwabessy J, Tran M, Huang Z, Przeslawski R, Radke
L, Howard F &amp; Nichol S (2017) Application of random forest and
generalised linear model and their hybrid methods with geostatistical
techniques to count data: Predicting sponge species richness.
<em>Environmental Modelling and Software</em>, <em>97</em>: 112–129.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://xp-song.github.io" class="external-link">Xiao Ping Song</a>,
<a href="https://github.com/edwintyw" class="external-link">Edwin Tan</a>,
<a href="https://github.com/rachelleesk" class="external-link">Rachel Lee</a>,
<a href="https://github.com/hongjhun" class="external-link">Hong Jhun Sim</a>,
<a href="https://github.com/JustinNai" class="external-link">Justin Nai</a>,
<a href="https://github.com/kwekiii" class="external-link">Kwek Yan Chong</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p><em>biodivercity</em> is a part of <a href="https://github.com/ecological-cities" class="external-link"><strong>ecological-cities</strong></a></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
