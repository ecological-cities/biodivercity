<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="biodivercity">
<title>Build Models â€¢ biodivercity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build Models">
<meta property="og:description" content="biodivercity">
<meta property="og:image" content="https://ecological-cities.github.io/biodivercity/reference/figures/logo.png">
<meta property="og:image:alt" content="Spatial predictions of biodiversity across urban landscapes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biodivercity</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/biodivercity.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/process-animal.html">1. Process animal data</a>
    <a class="dropdown-item" href="../articles/process-landscape.html">2. Process landscape data</a>
    <a class="dropdown-item" href="../articles/build-models.html">3. Build models</a>
    <a class="dropdown-item" href="../articles/apply-models.html">4. Apply models</a>
    <a class="dropdown-item" href="../articles/use-cases.html">5. Use cases</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more-details">More details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more-details">
    <a class="dropdown-item" href="../articles/more/animals-survey-protocols.html">Animals - Survey protocols</a>
    <a class="dropdown-item" href="../articles/more/animals-data-summaries.html">Animals - Data summaries</a>
    <a class="dropdown-item" href="../articles/more/animals-species-analyses.html">Animals - Species-level analyses</a>
    <a class="dropdown-item" href="../articles/more/animals-simulate-missing-surveys.html">Animals - Simulate missing surveys</a>
    <a class="dropdown-item" href="../articles/more/test-models.html">Models - Test accuracy</a>
    <h6 class="dropdown-header" data-toc-skip>Models - Future updates</h6>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://xp-song.github.io/project/birt/">About</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ecological-cities/biodivercity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="build-models_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="build-models_files/jquery-1.12.4/jquery.min.js"></script><link href="build-models_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="build-models_files/leaflet-1.3.1/leaflet.js"></script><link href="build-models_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="build-models_files/proj4-2.6.2/proj4.min.js"></script><script src="build-models_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="build-models_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="build-models_files/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="build-models_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="build-models_files/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="build-models_files/kePrint-0.0.1/kePrint.js"></script><link href="build-models_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Build Models</h1>
            <h3 data-toc-skip class="subtitle">Build and summarise GLMM models with processed animal and landscape data</h3>
                        <h4 data-toc-skip class="author">Edwin Tan</h4>
            
            <h4 data-toc-skip class="date">2022-08-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ecological-cities/biodivercity/blob/HEAD/vignettes/build-models.Rmd" class="external-link"><code>vignettes/build-models.Rmd</code></a></small>
      <div class="d-none name"><code>build-models.Rmd</code></div>
    </div>

    
    
<p>Following the preparation of collected fauna and landscape data, this article outlines a workflow to build predictive models of animal diversity. Species density at sampling points were modelled against the summarised landscape metrics with generalised linear mixed-effects models (GLMMs) using the <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge</a></code> function. However, owing to the large number of landscape predictors at multiple buffer radii generated from the remotely sensed and open data, variable selection has to be performed as there is a limit to the number of variables <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge</a></code> is allowed to accept.</p>
<div class="section level2">
<h2 id="combining-fauna-and-landscape-data">Combining fauna and landscape data<a class="anchor" aria-label="anchor" href="#combining-fauna-and-landscape-data"></a>
</h2>
<p>To build the models, animal and landscape datasets as processed in the previous two articles have to be combined and prepared.</p>
<p>First, load the required packages to run the analysis:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/ecological-cities/biodivercity" class="external-link">"biodivercity"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org" class="external-link">"tidyverse"</a></span><span class="op">)</span> <span class="co"># to process/wrangle data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span><span class="op">)</span> <span class="co"># to process landscape data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/mtennekes/tmap" class="external-link">"tmap"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">"kableExtra"</a></span><span class="op">)</span></code></pre></div>
<p>In this short example, load the datasets and filter for <code>area == "PG"</code> and <code>period == 1</code> only.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">animal_observations</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">animal_surveys</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sampling_points"</span><span class="op">)</span> 


<span class="va">observations</span> <span class="op">&lt;-</span> <span class="va">animal_observations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">area</span> <span class="op">==</span> <span class="st">"PG"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">surveys</span> <span class="op">&lt;-</span> <span class="va">animal_surveys</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">area</span> <span class="op">==</span> <span class="st">"PG"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">points</span> <span class="op">&lt;-</span> <span class="va">sampling_points</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">area</span> <span class="op">==</span> <span class="st">"PG"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Animal observations are then tallied to retrieve species richness at each point. The <code>tally_observations</code> function can be used with the argument <code>level = "point"</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">birds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tally_observations.html">tally_observations</a></span><span class="op">(</span><span class="va">observations</span>,
                            <span class="va">surveys</span>,
                            specify_taxon <span class="op">=</span> <span class="st">"Aves"</span>,
                            specify_area <span class="op">=</span> <span class="st">"PG"</span>,
                            specify_period <span class="op">=</span> <span class="fl">1</span>,
                            level <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>sprich <span class="op">=</span> <span class="va">n</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = c("point_id", "area", "period", "taxon")</span></code></pre>
<p>Re-calculate the landscape metrics for the area of Punggol with the <code>ndvi_mosaic.tif</code> raster by first classifying for vegetation with <code><a href="../reference/classify_image_binary.html">classify_image_binary()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ndvi_mosaic</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ndvi_mosaic.tif"</span>, package<span class="op">=</span><span class="st">"biodivercity"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">veg_classified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify_image_binary.html">classify_image_binary</a></span><span class="op">(</span><span class="va">ndvi_mosaic</span>, threshold <span class="op">=</span> <span class="st">"otsu"</span><span class="op">)</span></code></pre></div>
<p>The classified raster <code>veg_classified</code> is then input into <code>genfeatures_lsm()</code> as per the <code>Process landscape</code> article to retrieve relevant landscape metrics.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">points</span> <span class="op">&lt;-</span> <span class="fu">genfeatures_lsm</span><span class="op">(</span>raster <span class="op">=</span> <span class="va">veg_classified</span>,
                          points <span class="op">=</span> <span class="va">points</span>,
                          buffer_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span>, <span class="co"># in metres</span>
                          level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"class"</span><span class="op">)</span>,
                          class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"veg"</span><span class="op">)</span>,
                          class_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># pixel value of class</span></code></pre></div>
<p>Finally, the two datasets will be combined with an <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join()</a></code>. An input dataset for model building will follow the same format.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">birds</span> <span class="op">&lt;-</span> <span class="va">birds</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">points</span>, 
             by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"town"</span>, <span class="st">"round"</span>, <span class="st">"point_id"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">birds</span><span class="op">)</span></code></pre></div>
<hr>
<div class="section level3">
<h3 id="if-too-many-variables-are-present-for-mumindredge">If too many variables are present for <code>MuMIn::dredge</code>:<a class="anchor" aria-label="anchor" href="#if-too-many-variables-are-present-for-mumindredge"></a>
</h3>
<p>For this collection of articles, random forest models were first used to select variables based on their relative importance in improving model performance, i.e., averaged variable importance (Arthur et al., 2010; Li et al., 2017). The random forest algorithm is a machine learning technique that can handle and reduce the effects of overfitting, as well as the collinearity and selection bias of predictors (Hothorn et al., 2006). In the following sections, the example variables were selected using the <code>randomForest</code> package.</p>
</div>
</div>
<div class="section level2">
<h2 id="building-the-glm-models">Building the GLM models<a class="anchor" aria-label="anchor" href="#building-the-glm-models"></a>
</h2>
<p>Now, load the necessary packages to run the model building:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/" class="external-link">"lme4"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"MuMIn"</span><span class="op">)</span></code></pre></div>
<p>Bird species density and landscape data for sampling points across six areas (towns) in Singapore from the example data <code>model_data</code> will be used to demonstrate the model building process in this article. The variable selection output using random forest is also loaded from <code>model_variables</code> to inform <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">model_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">model_variables</span><span class="op">)</span></code></pre></div>
<p>Before running <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge</a></code>, model constraints have to be considered to avoid combinations of variables that represented similar landscape characteristics. For example, for each land cover class, only one of each metric type could be present in the fitted model, and similar landscape predictors at different buffer radii were not allowed. To do so, <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge</a></code> accepts expressions for the <code>subset</code> argument and such an object is automatically created from <code>model_variables</code> below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="va">model_variables</span><span class="op">$</span><span class="va">variable</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># unique combinations of variables</span>
  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">V1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">V1</span>, <span class="st">"&amp;"</span>, <span class="va">V2</span><span class="op">)</span><span class="op">)</span>
  
<span class="co"># unique combinations of landscape metrics by type</span>
<span class="va">lsm_comb</span> <span class="op">&lt;-</span> <span class="fu">landscapemetrics</span><span class="fu">::</span><span class="fu"><a href="https://r-spatialecology.github.io/landscapemetrics/reference/list_lsm.html" class="external-link">list_lsm</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">metric</span>, <span class="va">type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="va">metric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># group_by(type) %&gt;% </span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"type"</span>, values_from <span class="op">=</span> <span class="st">"metric"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span>MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># get unique landscape classes</span>
<span class="va">lsm_classes</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html" class="external-link">str_extract</a></span><span class="op">(</span><span class="va">model_variables</span><span class="op">$</span><span class="va">predictor</span>, <span class="st">"(?&lt;=lsm_)([^_]*)_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span>
  
<span class="va">subset_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lsm_comb</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># extract combinations in var_comb that match rows in lsm_comb</span>

  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">lsm_classes</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>

    <span class="va">to_subset</span> <span class="op">&lt;-</span>
      <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">var_comb</span>,
           <span class="va">var_comb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{lsm_classes[j]}{lsm_comb$V1[i]}"</span><span class="op">)</span>, <span class="va">V1</span><span class="op">)</span> <span class="op">&amp;</span>
                      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{lsm_classes[j]}{lsm_comb$V2[i]}"</span><span class="op">)</span>, <span class="va">V2</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span>

    <span class="va">to_subset_inverted</span> <span class="op">&lt;-</span> <span class="co"># if the combination is the other way round</span>
      <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">var_comb</span>,
           <span class="va">var_comb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{lsm_classes[j]}{lsm_comb$V2[i]}"</span><span class="op">)</span>, <span class="va">V1</span><span class="op">)</span> <span class="op">&amp;</span>
                      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{lsm_classes[j]}{lsm_comb$V1[i]}"</span><span class="op">)</span>, <span class="va">V2</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span>

    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">to_subset</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
      <span class="va">subset_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">subset_vec</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">to_subset</span><span class="op">$</span><span class="va">subset</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>

    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">to_subset_inverted</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
      <span class="va">subset_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">subset_vec</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">to_subset_inverted</span><span class="op">$</span><span class="va">subset</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>

  <span class="op">}</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">to_subset</span>, <span class="va">i</span>, <span class="va">j</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">subset_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"!("</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">subset_vec</span>, collapse <span class="op">=</span> <span class="st">") &amp; !("</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="co"># returns exp - subset doesn't accept paste</span></code></pre></div>
<p>Model data should then be scaled before building the models.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># scale/center model_data</span>

<span class="va">model_data</span> <span class="op">&lt;-</span> <span class="va">model_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">&amp;</span> 
                  <span class="op">!</span><span class="va">sprich</span>, 
                <span class="va">scale</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>For the <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge</a></code> function, a global model has to be fitted as a primary input. A null model is also fitted for the <code>extra</code> argument to calculate a delta-AIC value for model selection.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_global</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"sprich"</span>, <span class="st">"~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">model_variables</span><span class="op">$</span><span class="va">variable</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span>, <span class="st">"+ (1|town) "</span><span class="op">)</span>,
                      family <span class="op">=</span> <span class="va">poisson</span>,
                      data <span class="op">=</span> <span class="va">model_data</span>,
                      na.action <span class="op">=</span> <span class="st">"na.fail"</span>,
                      control <span class="op">=</span> <span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span>

<span class="va">model_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">sprich</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">town</span><span class="op">)</span>,
                    family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">model_data</span><span class="op">)</span></code></pre></div>
<p>The <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge</a></code> function is then run with <code>model_global</code>, <code>subset = subset_exp</code> and <code>m.lim=c(NA,9)</code> as model combination constraints.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">dredge</a></span><span class="op">(</span><span class="va">model_global</span>,
                    subset<span class="op">=</span> <span class="va">subset_exp</span>,
                    m.lim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">9</span><span class="op">)</span>, <span class="co"># max of 9 variables</span>
                    rank<span class="op">=</span><span class="st">"AICc"</span>,
                    extra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>R2 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/r.squaredGLMM.html" class="external-link">r.squaredGLMM</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">model_null</span><span class="op">)</span><span class="op">[</span><span class="st">"delta"</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co"># reduce size of huge object - subset only top models </span>
<span class="va">model_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">model_glm</span>, 
                   <span class="va">delta</span> <span class="op">&lt;</span> <span class="fl">8</span>,
                   recalc.weights<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>The resulting <code>model_glm</code> object contains all of the top models with values of Î”AIC &lt; 8. Here, a summary of the top models with values of Î”AIC &lt; 2 can be viewed:</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<strong>Summary of best models ranked based on automated model selection from <code><a href="https://rdrr.io/pkg/MuMIn/man/dredge.html" class="external-link">MuMIn::dredge()</a></code> (Î”AIC &lt; 2).</strong>
</caption>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
(Intercept)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r100m_osm_buildingVol_m3
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
r200m_lsm_veg_area_mn
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
r200m_lsm_veg_gyrate_mn
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
r200m_lsm_veg_lsi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
r400m_lsm_water_pd
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
r50m_lsm_veg_contig_mn
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
r50m_lsm_veg_para_mn
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
r50m_osm_laneDensity
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
R2.R2m
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
R2.R2c
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
logLik
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
AICc
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
delta
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
weight
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
163859
</td>
<td style="text-align:right;">
3.166
</td>
<td style="text-align:right;">
-0.096
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
0.079
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
-0.052
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
-0.07
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
0.495
</td>
<td style="text-align:right;">
0.577
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-296.361
</td>
<td style="text-align:right;">
605.626
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.026
</td>
</tr>
<tr>
<td style="text-align:left;">
98323
</td>
<td style="text-align:right;">
3.166
</td>
<td style="text-align:right;">
-0.096
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
0.08
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
-0.052
</td>
<td style="text-align:left;">
0.066
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
0.491
</td>
<td style="text-align:right;">
0.576
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-296.670
</td>
<td style="text-align:right;">
606.244
</td>
<td style="text-align:right;">
0.619
</td>
<td style="text-align:right;">
0.019
</td>
</tr>
<tr>
<td style="text-align:left;">
163851
</td>
<td style="text-align:right;">
3.166
</td>
<td style="text-align:right;">
-0.098
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
-0.055
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
-0.071
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
0.494
</td>
<td style="text-align:right;">
0.573
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-296.889
</td>
<td style="text-align:right;">
606.680
</td>
<td style="text-align:right;">
1.055
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
<tr>
<td style="text-align:left;">
426003
</td>
<td style="text-align:right;">
3.165
</td>
<td style="text-align:right;">
-0.095
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
-0.053
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
-0.062
</td>
<td style="text-align:left;">
-0.021
</td>
<td style="text-align:right;">
0.498
</td>
<td style="text-align:right;">
0.576
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-295.990
</td>
<td style="text-align:right;">
607.197
</td>
<td style="text-align:right;">
1.571
</td>
<td style="text-align:right;">
0.012
</td>
</tr>
<tr>
<td style="text-align:left;">
98315
</td>
<td style="text-align:right;">
3.166
</td>
<td style="text-align:right;">
-0.099
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
-0.055
</td>
<td style="text-align:left;">
0.067
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
0.489
</td>
<td style="text-align:right;">
0.572
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-297.250
</td>
<td style="text-align:right;">
607.403
</td>
<td style="text-align:right;">
1.778
</td>
<td style="text-align:right;">
0.011
</td>
</tr>
<tr>
<td style="text-align:left;">
163923
</td>
<td style="text-align:right;">
3.165
</td>
<td style="text-align:right;">
-0.090
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
-0.022
</td>
<td style="text-align:right;">
-0.052
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
-0.061
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:right;">
0.495
</td>
<td style="text-align:right;">
0.577
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-296.165
</td>
<td style="text-align:right;">
607.547
</td>
<td style="text-align:right;">
1.922
</td>
<td style="text-align:right;">
0.010
</td>
</tr>
</tbody>
</table>
</div>






















<p>Furthermore, to View the breakdown of variables in the top models, a plot of the top important variables and their sum of model weights across all models can be produced:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">bestmodels_info</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span><span class="op">)</span>

<span class="va">imp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">MuMIn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/sumofweights.html" class="external-link">sw</a></span><span class="op">(</span><span class="va">bestmodels_info</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>imp <span class="op">=</span> <span class="va">MuMIn..sw.bestmodels_info.</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"var"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">coef</span>, by <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">effect</span><span class="op">)</span>, <span class="st">"Mixed (factor)"</span>, <span class="va">effect</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">effect</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span>, <span class="st">"Mixed (factor)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">imp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">imp</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">var</span>, <span class="va">imp</span><span class="op">)</span>, 
                     fill <span class="op">=</span> <span class="va">effect</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sum of weights"</span>, y <span class="op">=</span> <span class="st">"Variables"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4daf4a"</span>, <span class="st">"#e41a1c"</span>, <span class="st">"#377eb8"</span><span class="op">)</span>,
                    name <span class="op">=</span> <span class="st">"Effect"</span><span class="op">)</span></code></pre></div>
<p><img src="build-models_files/figure-html/plot%20of%20coefs-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">coef</span>, caption <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"**Mean coefficient value for each predictor within the best models.**"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="st">"striped"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html" class="external-link">scroll_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"300px"</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
<strong>Mean coefficient value for each predictor within the best models.</strong>
</caption>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
var
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
value
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
effect
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
r100m_osm_buildingVol_m3
</td>
<td style="text-align:right;">
-0.0957250
</td>
<td style="text-align:left;">
Negative
</td>
</tr>
<tr>
<td style="text-align:left;">
r200m_lsm_veg_gyrate_mn
</td>
<td style="text-align:right;">
0.0766337
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;">
r400m_lsm_water_pd
</td>
<td style="text-align:right;">
-0.0531445
</td>
<td style="text-align:left;">
Negative
</td>
</tr>
<tr>
<td style="text-align:left;">
r50m_lsm_veg_para_mn
</td>
<td style="text-align:right;">
-0.0658100
</td>
<td style="text-align:left;">
Negative
</td>
</tr>
<tr>
<td style="text-align:left;">
r50m_lsm_veg_contig_mn
</td>
<td style="text-align:right;">
0.0662889
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;">
r200m_lsm_veg_area_mn
</td>
<td style="text-align:right;">
0.0728842
</td>
<td style="text-align:left;">
Positive
</td>
</tr>
<tr>
<td style="text-align:left;">
r50m_osm_laneDensity
</td>
<td style="text-align:right;">
-0.0210567
</td>
<td style="text-align:left;">
Negative
</td>
</tr>
<tr>
<td style="text-align:left;">
r200m_lsm_veg_lsi
</td>
<td style="text-align:right;">
-0.0219117
</td>
<td style="text-align:left;">
Negative
</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<hr>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Arthur AD, Li J, Henry S &amp; Cunningham SA (2010) Influence of woody vegetation on pollinator densities in oilseed Brassica fields in an Australian temperate landscape. <em>Basic and Applied Ecology</em>, <em>11</em>(5): 406â€“414.</p>
<p>Hothorn T, Hornik K &amp; Zeileis A (2006) Unbiased recursive partitioning: A conditional inference framework. <em>Journal of Computational and Graphical Statistics</em>, <em>15</em>(3): 651â€“674.</p>
<p>Li J, Alvarez B, Siwabessy J, Tran M, Huang Z, Przeslawski R, Radke L, Howard F &amp; Nichol S (2017) Application of random forest and generalised linear model and their hybrid methods with geostatistical techniques to count data: Predicting sponge species richness. <em>Environmental Modelling and Software</em>, <em>97</em>: 112â€“129.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Copyright Â© 2022 <a href="https://github.com/kwekiii" class="external-link">Kwek Yan Chong</a>, <a href="https://xp-song.github.io" class="external-link">Xiao Ping Song</a>, <a href="https://github.com/JustinNai" class="external-link">Justin Nai</a>, <a href="https://github.com/edwintyw" class="external-link">Edwin Tan</a>, <a href="https://github.com/hongjhun" class="external-link">Hong Jhun Sim</a> and contributors.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p><em>biodivercity</em> is a part of <a href="https://github.com/ecological-cities" class="external-link"><strong>ecological-cities</strong></a></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
