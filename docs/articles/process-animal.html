<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="biodivercity">
<title>Process Animal Data â€¢ biodivercity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Process Animal Data">
<meta property="og:description" content="biodivercity">
<meta property="og:image" content="https://ecological-cities.github.io/biodivercity/reference/figures/logo.png">
<meta property="og:image:alt" content="Biodiversity Indices for City Landscapes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biodivercity</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/biodivercity.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/process-landscape.html">1. Process landscape data</a>
    <a class="dropdown-item" href="../articles/process-animal.html">2. Process animal data</a>
    <h6 class="dropdown-header" data-toc-skip>3. Build models</h6>
    <a class="dropdown-item" href="../articles/apply-models.html">4. Apply models</a>
    <a class="dropdown-item" href="../articles/test-models.html">5. Test models</a>
    <h6 class="dropdown-header" data-toc-skip>6. Scoring and benchmarking</h6>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more-details">More details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more-details">
    <a class="dropdown-item" href="../articles/more/animals-survey-protocols.html">Animals - Survey Protocols</a>
    <a class="dropdown-item" href="../articles/more/animals-data-summaries.html">Animals - Data summaries</a>
    <a class="dropdown-item" href="../articles/more/animals-species-analyses.html">Animals - Species-level analyses</a>
    <a class="dropdown-item" href="../articles/more/animals-simulate-missing-surveys.html">Animals - Simulate missing surveys</a>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Land cover patterns</h6>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Urban density</h6>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Monitoring vs. Planning</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Local diversity</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Community diversity</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Future updates</h6>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://xp-song.github.io/project/birt/">About</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ecological-cities/biodivercity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="process-animal_files/kePrint-0.0.1/kePrint.js"></script><link href="process-animal_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Process Animal Data</h1>
            <h3 data-toc-skip class="subtitle">Clean up data from animal surveys</h3>
                        <h4 data-toc-skip class="author">Edwin Tan</h4>
            
            <h4 data-toc-skip class="date">2022-02-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ecological-cities/biodivercity/blob/HEAD/vignettes/process-animal.Rmd" class="external-link"><code>vignettes/process-animal.Rmd</code></a></small>
      <div class="d-none name"><code>process-animal.Rmd</code></div>
    </div>

    
    
<p>Animal observations from on-site surveys can be used to build predictive models of animal diversity, or summarised to directly compare animal diversity between different areas or time periods. This article outlines the ways to format, process and check the animal data.</p>
<p>First, load the necessary packages to run the analysis:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/ecological-cities/biodivercity" class="external-link">"biodivercity"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span> <span class="co"># data processing</span></code></pre></div>
<p><br></p>
<div class="section level2">
<h2 id="data-format">Data format<a class="anchor" aria-label="anchor" href="#data-format"></a>
</h2>
<p>Data from animal surveys can be organised into two separate tables: (1) a record of animal observations during each survey; and (2) reference information about each survey. The existence of (2) also ensures that surveys with zero animal observations are accounted for. More details on how data are collected can be found in <code><a href="../articles/more/animals-survey-protocols.html">vignette("animals-survey-protocols")</a></code>. Examples of data within the two tables are shown below:</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<strong>Table: Example showing animal observations recorded during surveys.</strong> Each row represents a unique observation at a specified time, which includes the species name and count (abundance) of individuals. Refer to <code><a href="../reference/animal_observations.html">help(animal_observations)</a></code> for more information.
</caption>
<thead><tr>
<th style="text-align:left;">
survey_id
</th>
<th style="text-align:left;">
point_id
</th>
<th style="text-align:left;">
area
</th>
<th style="text-align:right;">
period
</th>
<th style="text-align:right;">
cycle
</th>
<th style="text-align:left;">
resampled
</th>
<th style="text-align:left;">
start_time
</th>
<th style="text-align:left;">
time
</th>
<th style="text-align:left;">
taxon
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
family
</th>
<th style="text-align:left;">
genus
</th>
<th style="text-align:right;">
abundance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1 QTNa14a_P 1 Odonata
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 14:00:00
</td>
<td style="text-align:left;">
2016-08-04 14:01:00
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
Rhyothemis phyllis
</td>
<td style="text-align:left;">
Libellulidae
</td>
<td style="text-align:left;">
Rhyothemis spp.
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
1 QTNa14a_P 1 Odonata
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 14:00:00
</td>
<td style="text-align:left;">
2016-08-04 14:12:00
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
Crocothemis servilia
</td>
<td style="text-align:left;">
Libellulidae
</td>
<td style="text-align:left;">
Crocothemis spp.
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1 QTNa14a_P 1 Odonata
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 14:00:00
</td>
<td style="text-align:left;">
2016-08-04 14:15:00
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
Neurothemis fluctuans
</td>
<td style="text-align:left;">
Libellulidae
</td>
<td style="text-align:left;">
Neurothemis spp.
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1 QTNa14a_P 1 Odonata
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 14:00:00
</td>
<td style="text-align:left;">
2016-08-04 14:23:00
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
Crocothemis servilia
</td>
<td style="text-align:left;">
Libellulidae
</td>
<td style="text-align:left;">
Crocothemis spp.
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1 QTNa14a_P 1 Odonata
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 14:00:00
</td>
<td style="text-align:left;">
2016-08-04 14:28:00
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
Neurothemis fluctuans
</td>
<td style="text-align:left;">
Libellulidae
</td>
<td style="text-align:left;">
Neurothemis spp.
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1 QTNb1a_P 1 Odonata
</td>
<td style="text-align:left;">
QTNb1a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 14:44:00
</td>
<td style="text-align:left;">
2016-08-04 14:44:00
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
Neurothemis fluctuans
</td>
<td style="text-align:left;">
Libellulidae
</td>
<td style="text-align:left;">
Neurothemis spp.
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<strong>Table: Example showing the information recorded for each animal survey.</strong> Each row represents a unique 30-minute survey. Refer to <code><a href="../reference/animal_surveys.html">help(animal_surveys)</a></code> for more information.
</caption>
<thead><tr>
<th style="text-align:left;">
survey_id
</th>
<th style="text-align:left;">
point_id
</th>
<th style="text-align:left;">
area
</th>
<th style="text-align:right;">
period
</th>
<th style="text-align:right;">
cycle
</th>
<th style="text-align:left;">
taxon
</th>
<th style="text-align:left;">
resampled
</th>
<th style="text-align:left;">
start_time
</th>
<th style="text-align:left;">
notes
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1 QTNa14a_P 1 Odonata
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 14:00:00
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1 QTNb1a_P 1 Odonata
</td>
<td style="text-align:left;">
QTNb1a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 14:44:00
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1 QTNa14a_P 1 Amphibia
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Amphibia
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 19:55:00
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1 QTNb1a_P 1 Amphibia
</td>
<td style="text-align:left;">
QTNb1a_P
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Amphibia
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-04 20:40:00
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1 PGT15 1 Aves
</td>
<td style="text-align:left;">
PGT15
</td>
<td style="text-align:left;">
PG
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-08 07:00:00
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
1 PGT14 1 Aves
</td>
<td style="text-align:left;">
PGT14
</td>
<td style="text-align:left;">
PG
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2016-08-08 07:33:00
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<p>These example data are present in the package, and can be previewed by running the following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">animal_observations</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">animal_observations</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 x 13</span></span>
<span class="co">##   survey_id            point_id area  period cycle resampled start_time         </span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> 1 QTNa14a_P 1 Odona~ QTNa14a~ QT         1     1 <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">14:00:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">2</span> 1 QTNa14a_P 1 Odona~ QTNa14a~ QT         1     1 <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">14:00:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> 1 QTNa14a_P 1 Odona~ QTNa14a~ QT         1     1 <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">14:00:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">4</span> 1 QTNa14a_P 1 Odona~ QTNa14a~ QT         1     1 <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">14:00:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">5</span> 1 QTNa14a_P 1 Odona~ QTNa14a~ QT         1     1 <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">14:00:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">6</span> 1 QTNb1a_P 1 Odonata QTNb1a_P QT         1     1 <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">14:44:00</span></span>
<span class="co">## <span style="color: #949494;"># ... with 6 more variables: time &lt;dttm&gt;, taxon &lt;chr&gt;, species &lt;chr&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   family &lt;chr&gt;, genus &lt;chr&gt;, abundance &lt;dbl&gt;</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">animal_surveys</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">animal_surveys</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 x 9</span></span>
<span class="co">##   survey_id     point_id  area  period cycle taxon resampled start_time         </span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> 1 QTNa14a_P ~ QTNa14a_P QT         1     1 Odon~ <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">14:00:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">2</span> 1 QTNb1a_P 1~ QTNb1a_P  QT         1     1 Odon~ <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">14:44:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> 1 QTNa14a_P ~ QTNa14a_P QT         1     1 Amph~ <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">19:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">4</span> 1 QTNb1a_P 1~ QTNb1a_P  QT         1     1 Amph~ <span style="color: #BB0000;">NA</span>        2016-08-04 <span style="color: #949494;">20:40:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">5</span> 1 PGT15 1 Av~ PGT15     PG         1     1 Aves  <span style="color: #BB0000;">NA</span>        2016-08-08 <span style="color: #949494;">07:00:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">6</span> 1 PGT14 1 Av~ PGT14     PG         1     1 Aves  <span style="color: #BB0000;">NA</span>        2016-08-08 <span style="color: #949494;">07:33:00</span></span>
<span class="co">## <span style="color: #949494;"># ... with 1 more variable: notes &lt;chr&gt;</span></span></code></pre>
<p><br></p>
<p>If necessary, the convenience function <code><a href="../reference/filter_observations.html">filter_observations()</a></code> may be used to filter the animal survey data based on specified grouping variables (e.g.Â <code>area</code>, <code>period</code>, <code>taxon</code>). For example, observations from bird (<code>Aves</code>) surveys in Tampines (<code>TP</code>) conducted during 2020-2021 (survey period <code>2</code>) can be filtered as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">observations_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_observations.html">filter_observations</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">animal_observations</span>, 
                                           survey_ref <span class="op">=</span> <span class="va">animal_surveys</span>,
                                           specify_taxon <span class="op">=</span> <span class="st">"Aves"</span>,
                                           specify_area <span class="op">=</span> <span class="st">"TP"</span>,
                                           specify_period <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span>

<span class="va">observations_subset</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 4,180 x 13</span></span>
<span class="co">##    survey_id      point_id area  period cycle resampled start_time         </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #BCBCBC;">10</span> 2 TPa3b 1 Aves TPa3b    TP         2     1 FALSE     2020-07-01 <span style="color: #949494;">06:55:00</span></span>
<span class="co">## <span style="color: #949494;"># ... with 4,170 more rows, and 6 more variables: time &lt;dttm&gt;, taxon &lt;chr&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   species &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, abundance &lt;dbl&gt;</span></span></code></pre>
<p>Note that the column <code>survey_id</code> will be converted to a factor variable, which includes levels that are not present in the observation data (i.e.Â no butterflies were observed during those surveys).</p>
<p><br></p>
<hr>
</div>
<div class="section level2">
<h2 id="data-checks">Data checks<a class="anchor" aria-label="anchor" href="#data-checks"></a>
</h2>
<p>Checks can be performed to remove group-level observations, to prevent over-counting the number of species when summarising the data afterwards. For instance, if the <em>species</em> name of an observed animal is unknown, surveyors may instead record such observations at a higher (group) level of classification, such as the <em>family</em> or <em>genus</em>. However, this same species recorded as a group-level entry may also be identified correctly (at the species-level) during other surveys at the same point/area (e.g.Â by another surveyor). When the number of species is tallied at each point/area, it may result in a double-count of the particular animal species.</p>
<p>For example, there are two species of swallows observed across all points in the example datasetâ€“<em>Hirundo tahitica</em> and <em>Hirundo rustica</em>. <em>Hirundo spp.</em> is entered (in the <code>species</code> column) when the species cannot be identified with confidence:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">observations_swallows</span> <span class="op">&lt;-</span> <span class="va">observations_subset</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Hirundo"</span>, <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">point_id</span>, <span class="va">species</span>, <span class="va">family</span>, <span class="va">genus</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">observations_swallows</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 42 x 5</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   area, point_id, species, family [42]</span></span>
<span class="co">##    area  point_id species          family       genus       </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> TP    TPa3b    Hirundo rustica  Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> TP    TPa3b    Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> TP    TPa15a   Hirundo rustica  Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> TP    TPa15a   Hirundo spp.     Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> TP    TPa68a_P Hirundo rustica  Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> TP    TPa68a_P Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> TP    TPa70_P  Hirundo rustica  Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> TP    TPa70_P  Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> TP    TPa16a   Hirundo spp.     Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> TP    TPa16a   Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #949494;"># ... with 32 more rows</span></span></code></pre>
<p>This would result in an inflated value when tallying in the number of species per point/area, since <em>Hirundo spp.</em> is a unique entry in the <code>species</code> column. For example, in the example dataset, a total of three swallow species would be reported at <code>TP</code> (Tampines <code>area</code>), rather than the two known to be present in Singapore:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">observations_swallows</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">species</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># tally by area</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 1 x 2</span></span>
<span class="co">##   area  `n()`</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> TP        3</span></code></pre>
<p>One way to avoid such double-counting is to remove these group-level entries if all species in that particular classification group are observed, at the specified granularity of interest (<code>point</code> or <code>area</code>). The function <code><a href="../reference/check_taxongrps.html">check_taxongrps()</a></code> identifies such group-level entries, as well as the total number of species within that grouping level (by referring to the columns <code>genus</code> and <code>family</code>). For example, for our dataset of swallows at Tampines (<code>TP</code>), we can check the number of unique species within the <em>Hirundo spp.</em> genus and <em>Hirundinidae</em> family:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">to_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_taxongrps.html">check_taxongrps</a></span><span class="op">(</span><span class="va">observations_swallows</span>, level <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span>
<span class="va">to_remove</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 2 x 3</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   area [1]</span></span>
<span class="co">##   area  name             n</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> TP    Hirundo spp.     2</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> TP    Hirundinidae     3</span></code></pre>
<p>These entries can subsequently be removed from the observational data <code>observations_swallows</code>, if they have been recorded in the <code>species</code> column:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filtered_observations</span> <span class="op">&lt;-</span> <span class="va">observations_swallows</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join</a></span><span class="op">(</span><span class="va">to_remove</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span> <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span><span class="op">)</span>

<span class="va">filtered_observations</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 32 x 5</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   area, point_id, species, family [32]</span></span>
<span class="co">##    area  point_id species          family       genus       </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> TP    TPa3b    Hirundo rustica  Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> TP    TPa3b    Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> TP    TPa15a   Hirundo rustica  Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> TP    TPa68a_P Hirundo rustica  Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> TP    TPa68a_P Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> TP    TPa70_P  Hirundo rustica  Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> TP    TPa70_P  Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> TP    TPa16a   Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> TP    TPa54    Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> TP    TPb13_E  Hirundo tahitica Hirundinidae Hirundo spp.</span>
<span class="co">## <span style="color: #949494;"># ... with 22 more rows</span></span></code></pre>
<p>To verify that these entries have been removed, we can re-tally the filtered observations; the number of species will be reduced by one:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filtered_observations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">species</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># tally by area</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 1 x 2</span></span>
<span class="co">##   area  `n()`</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> TP        2</span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Copyright Â© 2022 <a href="https://github.com/kwekiii" class="external-link">Kwek Yan Chong</a>, <a href="https://xp-song.github.io" class="external-link">Xiao Ping Song</a>, <a href="https://github.com/JustinNai" class="external-link">Justin Nai</a>, <a href="https://github.com/edwintyw" class="external-link">Edwin Tan</a>, <a href="https://github.com/hongjhun" class="external-link">Hong Jhun Sim</a> and contributors.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p><em>biodivercity</em> is a part of <a href="https://github.com/ecological-cities" class="external-link"><strong>ecological-cities</strong></a></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
