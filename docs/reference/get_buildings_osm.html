<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Download and process OpenStreetMap (OSM) building polygons within a specified geographical place,
from the Geofabrik database. It is a wrapper around
functions in the package osmextract, and
processes the downloaded files for subsequent analyses. Refer to package osmextract for
more details and options for input arguments when downloading the data."><title>Get building polygons from OpenStreetMap — get_buildings_osm • biodivercity</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get building polygons from OpenStreetMap — get_buildings_osm"><meta property="og:description" content="Download and process OpenStreetMap (OSM) building polygons within a specified geographical place,
from the Geofabrik database. It is a wrapper around
functions in the package osmextract, and
processes the downloaded files for subsequent analyses. Refer to package osmextract for
more details and options for input arguments when downloading the data."><meta property="og:image" content="https://ecological-cities.github.io/biodivercity/reference/figures/logo.png"><meta property="og:image:alt" content="Biodiversity Indices for City Landscapes"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biodivercity</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/biodivercity.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>1. Process landscape data</h6>
    <h6 class="dropdown-header" data-toc-skip>2. Process animal data</h6>
    <h6 class="dropdown-header" data-toc-skip>3. Build models</h6>
    <a class="dropdown-item" href="../articles/apply-models.html">4. Apply models</a>
    <h6 class="dropdown-header" data-toc-skip>5. Test models</h6>
    <h6 class="dropdown-header" data-toc-skip>6. Scoring and benchmarking</h6>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more-details">More details</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more-details">
    <a class="dropdown-item" href="../articles/more/animals-survey-protocols.html">Animals - Survey Protocols</a>
    <a class="dropdown-item" href="../articles/more/animals-data-summaries.html">Animals - Data summaries</a>
    <h6 class="dropdown-header" data-toc-skip>Animals - Species-level analyses</h6>
    <a class="dropdown-item" href="../articles/more/animals-simulate-missing-surveys.html">Animals - Simulate missing surveys</a>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Land cover patterns</h6>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Urban density</h6>
    <h6 class="dropdown-header" data-toc-skip>Landscapes - Monitoring vs. Planning</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Local diversity</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Community diversity</h6>
    <h6 class="dropdown-header" data-toc-skip>Models - Future updates</h6>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://xp-song.github.io/project/birt/">About</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ecological-cities/biodivercity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get building polygons from OpenStreetMap</h1>
      <small class="dont-index">Source: <a href="https://github.com/ecological-cities/biodivercity/blob/HEAD/R/get_buildings_osm.R" class="external-link"><code>R/get_buildings_osm.R</code></a></small>
      <div class="d-none name"><code>get_buildings_osm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Download and process OpenStreetMap (OSM) building polygons within a specified geographical <code>place</code>,
from the <a href="https://download.geofabrik.de" class="external-link">Geofabrik database</a>. It is a wrapper around
functions in the package <a href="https://docs.ropensci.org/osmextract/index.html" class="external-link"><code>osmextract</code></a>, and
processes the downloaded files for subsequent analyses. Refer to package <code>osmextract</code> for
more details and options for input arguments when downloading the data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">get_buildings_osm</span><span class="op">(</span>
  <span class="va">place</span>,
  date <span class="op">=</span> <span class="cn">NULL</span>,
  dir_raw <span class="op">=</span> <span class="fu">osmextract</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/osmextract/reference/oe_download_directory.html" class="external-link">oe_download_directory</a></span><span class="op">(</span><span class="op">)</span>,
  filename <span class="op">=</span> <span class="cn">NULL</span>,
  driver <span class="op">=</span> <span class="st">"GeoJSON"</span>,
  delete_dsn <span class="op">=</span> <span class="cn">TRUE</span>,
  append <span class="op">=</span> <span class="cn">NA</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>place</dt>
<dd><p><code>sf</code> object (with projected coordinate reference system). Geographical area to match with the (<code>.osm.pbf</code>) file in the data archive.
Argument passed to <code><a href="https://docs.ropensci.org/osmextract/reference/oe_match.html" class="external-link">osmextract::oe_match()</a></code>.</p></dd>
<dt>date</dt>
<dd><p>Date of OSM data snapshot to download. Refer to https://download.geofabrik.de
for the specific dates available. Defaults to <code>NULL</code> (download the latest available data).</p></dd>
<dt>dir_raw</dt>
<dd><p>character. Directory to download the raw unprocessed OSM data. Passed to
argument <code>download_directory</code> in <code><a href="https://docs.ropensci.org/osmextract/reference/oe_read.html" class="external-link">osmextract::oe_read()</a></code>.</p></dd>
<dt>filename</dt>
<dd><p>character (optional). File path to export output data.</p></dd>
<dt>driver</dt>
<dd><p>character (optional). Name of driver used to export output data, passed to <code><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">sf::st_write()</a></code>.
Defaults to 'GeoJSON'.</p></dd>
<dt>delete_dsn</dt>
<dd><p>logical (optional). Passed to <code><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">sf::st_write()</a></code>.</p></dd>
<dt>append</dt>
<dd><p>defaults to <code>NA</code>, which raises an error if a layer exists. Passed to <code><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">sf::st_write()</a></code>.</p></dd>
<dt>...</dt>
<dd><p>Other arguments passed to <code><a href="https://docs.ropensci.org/osmextract/reference/oe_read.html" class="external-link">osmextract::oe_read()</a></code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The processed building polygons (<code>sf</code> object).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Data is filtered by key-value attributes, where <code>building:</code> is not <code>NULL</code>.
The column <code>levels</code> is derived from <code>building:levels</code>; values were set to <code>1</code> if the
extracted value is empty or <code>NA</code>, and set to <code>NA</code> if <code>≤ 0</code> (i.e. underground);
values were then rounded up to the nearest whole number.
The column <code>area_m2</code> represents the building footprint area,
and <code>floorarea_m2</code> is calculated by multiplying the <code>area_m2</code> by the number of <code>levels</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pop_sgp</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pop_sgp</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">pop_sgp</span>, <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">32648</span><span class="op">)</span><span class="op">)</span> <span class="co"># transform to projected crs</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># merge all census blocks for chosen year (2020) into single multi-polygon</span></span>
<span class="r-in"><span class="co"># function requires that polygons are merged</span></span>
<span class="r-in"><span class="va">city_boundaries</span> <span class="op">&lt;-</span> <span class="va">pop_sgp</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">   <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html" class="external-link">st_union</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">   <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">   <span class="fu">smoothr</span><span class="fu">::</span><span class="fu"><a href="https://strimas.com/smoothr/reference/fill_holes.html" class="external-link">fill_holes</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'km^2'</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="co"># clean up</span></span>
<span class="r-in">   <span class="fu">smoothr</span><span class="fu">::</span><span class="fu"><a href="https://strimas.com/smoothr/reference/drop_crumbs.html" class="external-link">drop_crumbs</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'km^2'</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">   <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/valid.html" class="external-link">st_make_valid</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># run function</span></span>
<span class="r-in"><span class="fu">get_buildings_osm</span><span class="op">(</span>place <span class="op">=</span> <span class="va">city_boundaries</span>,</span>
<span class="r-in">                  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2021-01-01'</span><span class="op">)</span>,</span>
<span class="r-in">                  filename <span class="op">=</span> <span class="st">'buildings_osm-polygons_2021-01-01.geojson'</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Copyright © 2022 <a href="https://github.com/kwekiii" class="external-link">Kwek Yan Chong</a>, <a href="https://xp-song.github.io" class="external-link">Xiao Ping Song</a>, <a href="https://github.com/JustinNai" class="external-link">Justin Nai</a>, <a href="https://github.com/edwintyw" class="external-link">Edwin Tan</a>, <a href="https://github.com/hongjhun" class="external-link">Hong Jhun Sim</a> and contributors.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p><em>biodivercity</em> is a part of <a href="https://github.com/ecological-cities" class="external-link"><strong>ecological-cities</strong></a></p>
</div>

    </footer></div>

  

  

  </body></html>

