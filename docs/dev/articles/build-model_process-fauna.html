<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Process fauna survey data • biodivercity</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Process fauna survey data">
<meta property="og:description" content="biodivercity">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biodivercity</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/biodivercity.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/build-model_process-fauna.html">Process fauna survey data</a>
    </li>
    <li>
      <a href="../articles/build-model_process-landscape.html">Get and process landscape metrics</a>
    </li>
    <li>
      <a href="../articles/apply-model_predict-fauna.html">Predict fauna spatially</a>
    </li>
    <li>
      <a href="../articles/apply-model_validation.html">Cross-validation of models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="build-model_process-fauna_files/header-attrs-2.11/header-attrs.js"></script><script src="build-model_process-fauna_files/kePrint-0.0.1/kePrint.js"></script><link href="build-model_process-fauna_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Process fauna survey data</h1>
                        <h4 class="author">Author</h4>
            
            <h4 class="date">2021-10-26</h4>
      
      
      <div class="hidden name"><code>build-model_process-fauna.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<ul>
<li>
<code>filter_obs</code> is a short function for quick subsetting of the large fauna survey dataframe.</li>
<li>Surveys missed during the COVID-19 pandemic could have affected the observed species richness and density. <code>exclude_simulator</code> can be used to re-sample past surveys in the affected towns to estimate the decrease in species observed.</li>
<li><code>check_taxongrps</code></li>
<li>
<code>sptally_extractor</code> and <code>sac_extractor</code> allow users to generate quick summaries of collected fauna data in the forms of mean species richness and species accumulation curves respectively.</li>
</ul>
</div>
<div id="quick-subset-of-fauna-survey-data" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-subset-of-fauna-survey-data" class="anchor"></a>Quick subset of fauna survey data</h2>
<p>The <code>filter_obs</code> function is meant for quick subsetting of fauna survey data and metadata that follows the following formats:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fauna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">fauna</span><span class="op">)</span>
<span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fauna</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped">
<caption style="font-size: initial !important;">
<strong>Sample survey data format</strong>
</caption>
<thead><tr>
<th style="text-align:right;">
iteration
</th>
<th style="text-align:left;">
survey_id
</th>
<th style="text-align:left;">
round
</th>
<th style="text-align:left;">
point_id
</th>
<th style="text-align:right;">
cycle
</th>
<th style="text-align:left;">
priority
</th>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
town
</th>
<th style="text-align:left;">
resampled
</th>
<th style="text-align:left;">
landcover
</th>
<th style="text-align:left;">
isWater
</th>
<th style="text-align:left;">
isUGS
</th>
<th style="text-align:left;">
isConey
</th>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
start_time
</th>
<th style="text-align:left;">
recorder
</th>
<th style="text-align:left;">
time
</th>
<th style="text-align:left;">
taxon
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
family
</th>
<th style="text-align:left;">
genus
</th>
<th style="text-align:right;">
abundance
</th>
<th style="text-align:right;">
dist_m
</th>
<th style="text-align:left;">
notes
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 QTNa14a_P 1 Aves
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-10
</td>
<td style="text-align:left;">
2016-08-10 07:04:00
</td>
<td style="text-align:left;">
Sherry
</td>
<td style="text-align:left;">
2016-08-10 07:06:00
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
Aplonis panayensis
</td>
<td style="text-align:left;">
Sturnidae
</td>
<td style="text-align:left;">
Aplonis spp.
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 QTNa14a_P 1 Aves
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-10
</td>
<td style="text-align:left;">
2016-08-10 07:04:00
</td>
<td style="text-align:left;">
Sherry
</td>
<td style="text-align:left;">
2016-08-10 07:06:00
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
Pycnonotus goiavier
</td>
<td style="text-align:left;">
Pycnonotidae
</td>
<td style="text-align:left;">
Pycnonotus spp.
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 QTNa14a_P 1 Aves
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-10
</td>
<td style="text-align:left;">
2016-08-10 07:04:00
</td>
<td style="text-align:left;">
Sherry
</td>
<td style="text-align:left;">
2016-08-10 07:06:00
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
Treron vernans
</td>
<td style="text-align:left;">
Columbidae
</td>
<td style="text-align:left;">
Treron spp.
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 QTNa14a_P 1 Aves
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-10
</td>
<td style="text-align:left;">
2016-08-10 07:04:00
</td>
<td style="text-align:left;">
Sherry
</td>
<td style="text-align:left;">
2016-08-10 07:08:00
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
Aplonis panayensis
</td>
<td style="text-align:left;">
Sturnidae
</td>
<td style="text-align:left;">
Aplonis spp.
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 QTNa14a_P 1 Aves
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-10
</td>
<td style="text-align:left;">
2016-08-10 07:04:00
</td>
<td style="text-align:left;">
Sherry
</td>
<td style="text-align:left;">
2016-08-10 07:08:00
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
Aplonis panayensis
</td>
<td style="text-align:left;">
Sturnidae
</td>
<td style="text-align:left;">
Aplonis spp.
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 QTNa14a_P 1 Aves
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-10
</td>
<td style="text-align:left;">
2016-08-10 07:04:00
</td>
<td style="text-align:left;">
Sherry
</td>
<td style="text-align:left;">
2016-08-10 07:09:00
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
Hirundo rustica
</td>
<td style="text-align:left;">
Hirundinidae
</td>
<td style="text-align:left;">
Hirundo spp.
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped">
<caption style="font-size: initial !important;">
<strong>Sample survey info format</strong>
</caption>
<thead><tr>
<th style="text-align:right;">
iteration
</th>
<th style="text-align:left;">
survey_id
</th>
<th style="text-align:left;">
round
</th>
<th style="text-align:left;">
point_id
</th>
<th style="text-align:right;">
cycle
</th>
<th style="text-align:left;">
priority
</th>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
town
</th>
<th style="text-align:left;">
resampled
</th>
<th style="text-align:left;">
landcover
</th>
<th style="text-align:left;">
isWater
</th>
<th style="text-align:left;">
isUGS
</th>
<th style="text-align:left;">
isConey
</th>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
start_time
</th>
<th style="text-align:left;">
surveyors
</th>
<th style="text-align:left;">
weather
</th>
<th style="text-align:left;">
weather_station
</th>
<th style="text-align:right;">
rain_lastdate
</th>
<th style="text-align:right;">
rain_dailytotal_mm
</th>
<th style="text-align:right;">
rain_highest30min_mm
</th>
<th style="text-align:right;">
rain_highest60min_mm
</th>
<th style="text-align:right;">
rain_highest120min_mm
</th>
<th style="text-align:left;">
notes
</th>
<th style="text-align:left;">
subcategory
</th>
<th style="text-align:left;">
type_combined
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 QTNb1a_P 1 Amphibia
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
QTNb1a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Amphibia
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Nat veg
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-04
</td>
<td style="text-align:left;">
2016-08-04 20:40:00
</td>
<td style="text-align:left;">
Chloe, Sherry, Marcus, Jacqueline
</td>
<td style="text-align:left;">
Fair
</td>
<td style="text-align:left;">
Queenstown
</td>
<td style="text-align:right;">
20160803
</td>
<td style="text-align:right;">
9.6
</td>
<td style="text-align:right;">
6.2
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
9.0
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Nat veg (water)
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 QTNa14a_P 1 Aves
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
QTNa14a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
QT
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-10
</td>
<td style="text-align:left;">
2016-08-10 07:04:00
</td>
<td style="text-align:left;">
Chloe, Sherry
</td>
<td style="text-align:left;">
Cloudy
</td>
<td style="text-align:left;">
Queenstown
</td>
<td style="text-align:right;">
20160809
</td>
<td style="text-align:right;">
8.8
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:right;">
8.6
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Urban (water)
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 PGT8 1 Aves
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
PGT8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Aves
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
PG
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-11
</td>
<td style="text-align:left;">
2016-08-11 07:50:00
</td>
<td style="text-align:left;">
Chloe, Sherry, Emmanuel
</td>
<td style="text-align:left;">
Cloudy
</td>
<td style="text-align:left;">
Punggol
</td>
<td style="text-align:right;">
20160807
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
UGS
</td>
<td style="text-align:left;">
Urban UGS
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 PGNb4a_P 1 Odonata
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
PGNb4a_P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
PG
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Nat veg
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-12
</td>
<td style="text-align:left;">
2016-08-12 14:18:00
</td>
<td style="text-align:left;">
Chloe, Sherry
</td>
<td style="text-align:left;">
Overcast
</td>
<td style="text-align:left;">
Punggol
</td>
<td style="text-align:right;">
20160807
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Nat veg (water)
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 PGNa20_E 1 Odonata
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
PGNa20_E
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
PG
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-12
</td>
<td style="text-align:left;">
2016-08-12 15:13:00
</td>
<td style="text-align:left;">
Chloe, Sherry
</td>
<td style="text-align:left;">
Overcast
</td>
<td style="text-align:left;">
Punggol
</td>
<td style="text-align:right;">
20160807
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Urban (water)
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1 PGNa12_E 1 Odonata
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
PGNa12_E
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Odonata
</td>
<td style="text-align:left;">
2016/17
</td>
<td style="text-align:left;">
PG
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2016-08-12
</td>
<td style="text-align:left;">
2016-08-12 15:47:00
</td>
<td style="text-align:left;">
Chloe, Sherry
</td>
<td style="text-align:left;">
Overcast
</td>
<td style="text-align:left;">
Punggol
</td>
<td style="text-align:right;">
20160807
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
Urban (water)
</td>
</tr>
</tbody>
</table>
</div>
<p><code>filter_obs</code> can be used to easily subset the data with respect to <code>town</code>, <code>round</code> and/or <code>priority</code>. In the context of this package, the parameters <code>town</code>, <code>round</code> and <code>priority</code> refer to the spatial, temporal and taxonomic grouping of the input data. Alternatively, these parameters can also be arbitrarily assigned to any existing groups.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">butterflies</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">fauna</span>, survey_ref <span class="op">=</span> <span class="va">surveys</span>,
                   specify_priority <span class="op">=</span> <span class="st">"Lepidoptera"</span><span class="op">)</span>
<span class="va">tampines</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">fauna</span>, survey_ref <span class="op">=</span> <span class="va">surveys</span>,
                   specify_town <span class="op">=</span> <span class="st">"TP"</span><span class="op">)</span>
<span class="va">round_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">fauna</span>, survey_ref <span class="op">=</span> <span class="va">surveys</span>,
                     specify_round <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span></code></pre></div>
<p>For example, a specific set of surveys (i.e. butterfly surveys in Tampines from 2020-2021) can be filtered as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">butterflies_tampines_round_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">fauna</span>, survey_ref <span class="op">=</span> <span class="va">surveys</span>,
                   specify_priority <span class="op">=</span> <span class="st">"Lepidoptera"</span>,
                   specify_town <span class="op">=</span> <span class="st">"TP"</span>,
                   specify_round <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">butterflies_tampines_round_2</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped">
<caption style="font-size: initial !important;">
<strong>Observations of <em>butterflies</em> in <em>Tampines</em> from <em>2020-2021</em>.</strong>
</caption>
<thead><tr>
<th style="text-align:right;">
iteration
</th>
<th style="text-align:left;">
survey_id
</th>
<th style="text-align:left;">
round
</th>
<th style="text-align:left;">
point_id
</th>
<th style="text-align:right;">
cycle
</th>
<th style="text-align:left;">
priority
</th>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
town
</th>
<th style="text-align:left;">
resampled
</th>
<th style="text-align:left;">
landcover
</th>
<th style="text-align:left;">
isWater
</th>
<th style="text-align:left;">
isUGS
</th>
<th style="text-align:left;">
isConey
</th>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
start_time
</th>
<th style="text-align:left;">
recorder
</th>
<th style="text-align:left;">
time
</th>
<th style="text-align:left;">
taxon
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
family
</th>
<th style="text-align:left;">
genus
</th>
<th style="text-align:right;">
abundance
</th>
<th style="text-align:right;">
dist_m
</th>
<th style="text-align:left;">
notes
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2 TPa15a 1 Lepidoptera
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
TPa15a
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
2020/21
</td>
<td style="text-align:left;">
TP
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2020-07-01
</td>
<td style="text-align:left;">
2020-07-01 09:25:00
</td>
<td style="text-align:left;">
Justin
</td>
<td style="text-align:left;">
2020-07-01 09:26:00
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
Zizina otis lampa
</td>
<td style="text-align:left;">
Lycaenidae
</td>
<td style="text-align:left;">
Zizina spp.
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2 TPa15a 1 Lepidoptera
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
TPa15a
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
2020/21
</td>
<td style="text-align:left;">
TP
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2020-07-01
</td>
<td style="text-align:left;">
2020-07-01 09:25:00
</td>
<td style="text-align:left;">
Justin
</td>
<td style="text-align:left;">
2020-07-01 09:27:00
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
Zizina otis lampa
</td>
<td style="text-align:left;">
Lycaenidae
</td>
<td style="text-align:left;">
Zizina spp.
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2 TPa15a 1 Lepidoptera
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
TPa15a
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
2020/21
</td>
<td style="text-align:left;">
TP
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2020-07-01
</td>
<td style="text-align:left;">
2020-07-01 09:25:00
</td>
<td style="text-align:left;">
Justin
</td>
<td style="text-align:left;">
2020-07-01 09:42:00
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
Zizina otis lampa
</td>
<td style="text-align:left;">
Lycaenidae
</td>
<td style="text-align:left;">
Zizina spp.
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2 TPa15a 1 Lepidoptera
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
TPa15a
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
2020/21
</td>
<td style="text-align:left;">
TP
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2020-07-01
</td>
<td style="text-align:left;">
2020-07-01 09:25:00
</td>
<td style="text-align:left;">
Justin
</td>
<td style="text-align:left;">
2020-07-01 09:45:00
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
Zizina otis lampa
</td>
<td style="text-align:left;">
Lycaenidae
</td>
<td style="text-align:left;">
Zizina spp.
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2 TPa54 1 Lepidoptera
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
TPa54
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
2020/21
</td>
<td style="text-align:left;">
TP
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2020-07-07
</td>
<td style="text-align:left;">
2020-07-07 09:29:00
</td>
<td style="text-align:left;">
Edwin
</td>
<td style="text-align:left;">
2020-07-07 09:29:00
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
Zizina otis lampa
</td>
<td style="text-align:left;">
Lycaenidae
</td>
<td style="text-align:left;">
Zizina spp.
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2 TPa54 1 Lepidoptera
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
TPa54
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
2020/21
</td>
<td style="text-align:left;">
TP
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
Urban
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
2020-07-07
</td>
<td style="text-align:left;">
2020-07-07 09:29:00
</td>
<td style="text-align:left;">
Edwin
</td>
<td style="text-align:left;">
2020-07-07 09:29:00
</td>
<td style="text-align:left;">
Lepidoptera
</td>
<td style="text-align:left;">
Pelopidas mathias mathias
</td>
<td style="text-align:left;">
Hesperiidae
</td>
<td style="text-align:left;">
Pelopidas spp.
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="assessing-missing-data-with-past-records" class="section level2">
<h2 class="hasAnchor">
<a href="#assessing-missing-data-with-past-records" class="anchor"></a>Assessing missing data with past records</h2>
<p>When COVID-19 hit, fauna surveys scheduled within the Circuit Breaker period (Punggol and Queenstown Survey Round 2, Cycle 5) were not conducted. To simulate the effect on the loss in observed species richness and density with less surveys, the same number of surveys were randomly removed from the total survey number conducted during the same window of the previous survey year (Round 1, 2016/17). To examine the possible variation in species richness/density, bootstrapped repetitions were made for the respective number of missed surveys for each taxon.</p>
<ul>
<li>i.e. <strong>Aves (birds):</strong> 15 (PG) surveys were excluded with 100 bootstrapping scenarios</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude_bird_pg</span> <span class="op">&lt;-</span> <span class="fl">15</span>
<span class="va">rep</span> <span class="op">&lt;-</span> <span class="fl">100</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>

<span class="va">boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exclude_simulator.html">exclude_simulator</a></span><span class="op">(</span><span class="va">bird</span>, <span class="va">surveys</span>,
                          exclude_num <span class="op">=</span> <span class="va">exclude_bird_pg</span>, 
                          exclude_level <span class="op">=</span> <span class="st">"survey"</span>,
                          specify_points <span class="op">=</span> <span class="cn">NULL</span>, specify_towns <span class="op">=</span> <span class="cn">NULL</span>,
                          specify_rounds <span class="op">=</span> <span class="cn">NULL</span>, specify_cycles <span class="op">=</span> <span class="fl">5</span>, 
                          town_ignore <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"QT"</span>,<span class="st">"TP"</span>, <span class="st">"JW"</span>, <span class="st">"BS"</span>, <span class="st">"WL"</span><span class="op">)</span>, <span class="co"># for PG</span>
                          round_ignore <span class="op">=</span> <span class="st">"2"</span>, 
                          cycle_ignore <span class="op">=</span> <span class="cn">NULL</span>,
                          rep <span class="op">=</span> <span class="va">rep</span><span class="op">)</span></code></pre></div>
<p>The results can be visualised as a boxplot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># sp richness</span>
<span class="va">sp_rich</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">boot</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co"># mean(sp_rich) / nrow(boot)</span>
<span class="co"># quantile(sp_rich)</span>
<span class="va">sp_rich</span> <span class="op">&lt;-</span> <span class="va">sp_rich</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>n <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>full <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>priority <span class="op">=</span> <span class="st">"Aves"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>town <span class="op">=</span> <span class="st">"PG"</span><span class="op">)</span>

<span class="co"># A function factory for getting integer y-axis values.</span>
<span class="va">integer_breaks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">5</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">fxn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">breaks</span>, <span class="st">"labels"</span><span class="op">)</span>
  <span class="va">breaks</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">fxn</span><span class="op">)</span>
  <span class="op">}</span>

<span class="co"># plot boxplot of expected species</span>
<span class="va">sp_rich</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>priority <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">priority</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aves"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>

  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">town</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    
    <span class="fu">facet_wrap</span><span class="op">(</span> <span class="op">~</span> <span class="va">priority</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span>
    
    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">full</span><span class="op">)</span>, shape<span class="op">=</span><span class="fl">4</span>, size<span class="op">=</span><span class="fl">3.0</span>,
               color <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_boxplot</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, shape<span class="op">=</span><span class="fl">5</span>, size<span class="op">=</span><span class="fl">2.0</span><span class="op">)</span> <span class="op">+</span> <span class="co">#mean value</span>
  
    <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">integer_breaks</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">ylab</span><span class="op">(</span><span class="st">"No. of species"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
          panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="images/exclude-sim-sample-plot.png" alt=""><p class="caption"><strong>Regenerate with sample dataset.</strong> Boxplot of no. of species (species richness) at Punggol in the first Survey Round (2016/17), if similar no. of missed surveys were randomly excluded in Cycle 5 (COVID-19 circuit breaker period in Survey Round 2, 2019/20). The blue cross denotes the counts across full dataset, while the diamond symbol denotes the mean counts across the 100 bootstrapped repetitions of scenarios with excluded data.</p>
</div>
</div>
<div id="checking-fauna-data-entries-for-repeats-or-outdated-names" class="section level2">
<h2 class="hasAnchor">
<a href="#checking-fauna-data-entries-for-repeats-or-outdated-names" class="anchor"></a>Checking fauna data entries for repeats or outdated names</h2>
<p><strong>ATTN</strong>: <code>check_taxongrps.R</code> no longer used in <code>0_Process-fauna.Rmd</code>?</p>
</div>
<div id="summarising-fauna-data-entries" class="section level2">
<h2 class="hasAnchor">
<a href="#summarising-fauna-data-entries" class="anchor"></a>Summarising fauna data entries</h2>
<p>To generate summary figures quickly for large survey data accumulated throughout the study period, <code>sptally_extractor</code> and <code>sac_extractor</code> can calculate the <strong>mean species richness</strong> and <strong>species accumulation curves</strong> respectively. <code>sptally_extractor</code> can be specific to the point or individual survey levels, while <code>sac_extractor</code> is calculated at the broader spatial grouping of <code>town</code> to represent surveys as sampling effort. Similar to the <code>filter_obs</code> function covered above, the same parameters of <code>town</code>, <code>round</code> and <code>priority</code> can be specified.</p>
<div id="stacked-bar-plots-with-error" class="section level3">
<h3 class="hasAnchor">
<a href="#stacked-bar-plots-with-error" class="anchor"></a>Stacked bar plots with error</h3>
<p>An example of the sample dataset summarised with <code>sptally_extractor</code> to create a stacked bar plot for each <code>town</code> and <code>priority</code> (taxon):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># BY POINT</span>
<span class="va">normalised_perpt</span> <span class="op">&lt;-</span> 
  <span class="fu">foreach</span><span class="op">(</span>i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">fauna_normalised</span><span class="op">)</span>, 
          .packages <span class="op">=</span> <span class="st">"tidyverse"</span><span class="op">)</span> <span class="op">%dopar%</span> <span class="op">{</span>
 
  <span class="co">#get unique data to input to loop later</span>
  <span class="va">unique</span> <span class="op">&lt;-</span> <span class="va">surveys_normalised</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span>
    <span class="fu">distinct</span><span class="op">(</span><span class="va">town</span>, <span class="va">round</span>, <span class="va">priority</span><span class="op">)</span>
  
  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">unique</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  
    <span class="va">sptally_data</span> <span class="op">&lt;-</span> 
      <span class="fu"><a href="../reference/sptally_extractor.html">sptally_extractor</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">fauna_normalised</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                        survey_ref <span class="op">=</span> <span class="va">surveys_normalised</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                        specify_town <span class="op">=</span> <span class="va">unique</span><span class="op">$</span><span class="va">town</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, 
                        specify_round <span class="op">=</span> <span class="va">unique</span><span class="op">$</span><span class="va">round</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, 
                        specify_priority <span class="op">=</span> <span class="va">unique</span><span class="op">$</span><span class="va">priority</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,
                        level <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span>
    
    <span class="co"># bind to plot_sac &amp; overwrite</span>
    <span class="va">results</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op">%&gt;%</span>
      <span class="fu">bind_rows</span><span class="op">(</span><span class="va">sptally_data</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">sptally_data</span><span class="op">)</span>
  <span class="op">}</span>
            
  <span class="va">results</span>                     
<span class="op">}</span>

<span class="co"># summarise &amp; stats</span>
<span class="va">normalised_perpt</span> <span class="op">&lt;-</span> <span class="va">normalised_perpt</span> <span class="op">%&gt;%</span> 
  <span class="fu">map_dfr</span><span class="op">(</span><span class="op">~</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, .id <span class="op">=</span> <span class="st">"iteration"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># unlist </span>
  <span class="fu">mutate</span><span class="op">(</span>iteration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">iteration</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    
  <span class="co"># add iteration-level summaries</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">iteration</span>, 
           <span class="va">town</span>, <span class="va">round</span>, <span class="va">priority</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">n</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#,</span>
            <span class="co">#se = sd(n, na.rm = T)/sqrt(length(n))</span>
            <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Point"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="co"># for plotting</span>
  <span class="fu">mutate</span><span class="op">(</span>town <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">town</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PG"</span>, <span class="st">"QT"</span>, <span class="st">"TP"</span>,<span class="st">"JW"</span>, <span class="st">"BS"</span>, <span class="st">"WL"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>priority <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">priority</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Aves"</span>, <span class="st">"Lepidoptera"</span>, <span class="st">"Odonata"</span>,<span class="st">"Amphibia"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>round <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">round</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="images/sample-stacked-bar-plot.png" id="id" class="class" style="width:80.0%;height:80.0%" alt=""><p class="caption">Mean species richness (no. of species) per sampling point and survey, for each town and taxon. The error bars denote two standard deviations of the mean across all iterations. Note that the scale of the y-axis varies between the plots.</p>
</div>
</div>
<div id="species-accumulation-curves" class="section level3">
<h3 class="hasAnchor">
<a href="#species-accumulation-curves" class="anchor"></a>Species accumulation curves</h3>
<p>An example of the sample dataset summarised with <code>sac_extractor</code> to create a species accumulation curve for each <code>town</code> and <code>priority</code> (taxon):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># loop across all bootstrapped iterations</span>

<span class="va">plot_sac</span> <span class="op">&lt;-</span> 
  <span class="fu">foreach</span><span class="op">(</span>i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">fauna</span><span class="op">)</span>, 
          .packages <span class="op">=</span> <span class="st">"tidyverse"</span><span class="op">)</span> <span class="op">%dopar%</span> <span class="op">{</span>
  
  <span class="va">unique</span> <span class="op">&lt;-</span> <span class="va">surveys</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span>
    <span class="fu">distinct</span><span class="op">(</span><span class="va">town</span>, <span class="va">round</span>, <span class="va">priority</span><span class="op">)</span>
            
  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">unique</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">sac_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_extractor.html">sac_extractor</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">fauna</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, 
                              survey_ref <span class="op">=</span> <span class="va">surveys</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,
                              specify_town <span class="op">=</span> <span class="va">unique</span><span class="op">$</span><span class="va">town</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, 
                              specify_round <span class="op">=</span> <span class="va">unique</span><span class="op">$</span><span class="va">round</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, 
                              specify_priority <span class="op">=</span> <span class="va">unique</span><span class="op">$</span><span class="va">priority</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>
    
    <span class="co"># bind to plot_sac &amp; overwrite</span>
    <span class="va">results</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op">%&gt;%</span>
      <span class="fu">bind_rows</span><span class="op">(</span><span class="va">sac_data</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">sac_data</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">results</span>
<span class="op">}</span>

<span class="co"># unlist &amp; calc mean across iterations</span>
<span class="va">plot_sac</span> <span class="op">&lt;-</span> <span class="va">plot_sac</span> <span class="op">%&gt;%</span> 
  <span class="fu">map_dfr</span><span class="op">(</span><span class="op">~</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, .id <span class="op">=</span> <span class="st">"iteration"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>iteration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">iteration</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">town</span>, <span class="va">round</span>, <span class="va">priority</span>, <span class="va">sites</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">richness</span><span class="op">)</span>,
            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">richness</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="images/sac-sample-plot.png" id="id" class="class" style="width:80.0%;height:80.0%" alt=""><p class="caption">Species accumulation curves compare total, or ‘gamma’, diversity for the total sampling area, while accounting for differences in sampling effort. The mean species richness (line) and two standard deviations of the mean (shaded region) across all iterations are shown. Note that the scale of the y-axis varies between taxa.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
